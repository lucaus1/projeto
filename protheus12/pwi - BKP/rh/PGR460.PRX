#INCLUDE "Protheus.CH"
#INCLUDE "GPER460.CH"

Static _cRepDb	:= GetSrvProfString("RepositInDataBase","")
Static _cRep	:= SuperGetMv("MV_REPOSIT",.F.,"1")
Static _lRepDb	:= ( _cRepDb == "1" .And. _cRep == "2" )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GPER460    ³ Autor ³ R.H. - Mauro              ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao Ficha Registro                                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ GpeR460(void)                                                    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³         ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Programador ³ Data     ³ BOPS/FNC ³  Motivo da Alteracao                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±|Luis Ricardo|11/08/2010|18334/2010|Criacao da Funcao AJUSTASX3 para Ajuste no³±±
±±|Cinalli     |          |          |Inicializador Padrao do campo RA_DCARGO   ³±± 
±±|            |          |          |para permitir a impressao da descricao a  ³±±
±±|            |          |          |partir de uma filial a qual o usuario nao ³±±
±±|            |          |          |esteja logado.                            ³±± 
±±|Luis Ricardo|20/08/2010|19113/2010|No Brasil, se o Modulo SIGAORG NAO ESTIVER³±±
±±|Cinalli     |          |          |em uso, os campos RA_DEPTO e RA_DDEPTO nao³±± 
±±|            |          |          |devem ser utilizados nesta rotina. Foi	³±± 
±±|            |          |          |criada a funcao AJSX3DPT no GPEA010.	    ³±± 
±±|Luis Ricardo|24/08/2010|19426/2010|Ajuste na posicao da soma do nLin da fun- ³±±
±±|Cinalli     |          |          |cao fImpSalG (Impressao de Linhas detalhe ³±± 
±±|            |          |          |Modo Grafico) pois estava imprimindo a 	³±± 
±±|            |          |          |proxima linha com informacao de alteracao ³±± 
±±|            |          |          |salarial na mesma linha do cabecalho.		³±± 
±±|            |          |          |Ajuste na coluna de impressao da DATA DE  ³±± 
±±|            |          |          |pois estava avancando a coluna de impres- ³±± 
±±|            |          |          |sao da DATA ATE na mesma funcao qdo usua-	³±± 
±±|            |          |          |rio esta cadastrado com Data de 4 digitos.³±± 
±±|Luis Ricardo|05/11/2010|23666/2010|Ajuste no quadro das contribuicoes sindi- ³±±
±±|Cinalli     |          |          |cais quando o funcionario eh transferido  ³±± 
±±|            |          |          |de Filial. Ajustes de salvamento e restau-³±± 
±±|            |          |          |racao da area atual em todas as funcoes.  ³±±  
±±|            |          |          |Ajustes no X3_Relacao do campo RA_DESCSIN ³±± 
±±|            |          |          |para tratar a filial do registro a ser	³±± 
±±|            |          |          |impresso.									³±± 
±±|Luis Ricardo|08/12/2010|27659/2010|Ajuste na tela das contribuicoes sindicais³±±
±±|Cinalli     |          |          |quando o funcionario tem uma transferencia³±±
±±|            |          |          |de Filial e outra somente de CC ou de al-	³±±
±±|            |          |          |teracao de Sindicato. Alteracao na chamada³±±
±±|            |          |          |da funcao fTransf para preencher aChave	³±±
±±|            |          |          |somente com transf. de Empresa e de Filial³±±
±±|            |          |          |Foi necessario alterar a funcao FwCodEmp	³±±
±±|            |          |          |pela var cEmpAnt pois nao estava trazendo	³±±
±±|            |          |          |as informacoes completas da contribuicao	³±±
±±|            |          |          |sindical do funcionario transferido.		³±±  
±±³Alessandro  ³18/03/2011³06427/2011³Tratamento de novas funcionalidades p/ o  ³±±
±±³Santos      ³          ³          ³calculo de professores.                   ³±±
±±³Jonatas     ³12/04/2011³08740/2011³Inclusao de opcoes para filtro dos novos  ³±±
±±³            ³          ³          ³tipos de tarefas.                         ³±±
±±³Allyson M.  ³26/05/2011³12650/2011³Correcao da visualizacao/impressao da foto³±±
±±³            ³          ³          ³do funcionario quando o repositorio de    ³±±
±±³            ³          ³          ³imagens esta no banco de dados.          	³±±
±±|Renata      |09/06/2011|14127/2011|Ajuste na funcao fImpDep, p/qdo funciona- ³±±
±±|            |          |          |rio tiver mais de um dependente e o nome e³±±
±±|            |          |          |data de nascimento forem iguais, inclui-lo³±±
±±|            |          |          |apenas na impressao da ficha.				³±±
±±|Luciana     |20/07/2011|17886/2011|Ajuste na funcao fImpPeriodo, para exibir ³±±
±±|            |          |          |o periodo utilizado para impressao dos    ³±±
±±|            |          |          |dados apenas quando as perguntas Data Ini-³±±
±±|            |          |          |cial e Data Final estiverem preenchidas.  ³±± 
±±|Gustavo M.  |15/12/2011|TEERH8    |Ajuste no tamanho do relatorio, alem de   ³±±
±±|            |          |          |correcao da sobreposicao de valores.      ³±±
±±|Fabio G.    |10/02/2012|TEMMFY    |Ajuste da Funcao fImpDep() para que as In-³±±
±±|            |          |          |formacoes de Grau Parent. impressa no Rel.³±±
±±|Leandro Dr. |23/05/2012|TFAXW7    |Ajuste para possibilitar a impressao de   ³±±
±±|            |          | 	     |foto JPG na ficha de registro.	        ³±±
±±|Allyson M.  |23/07/2012|TFLDDI    |Ajuste para imprimir a descricao da nacio-³±±
±±|            |          | 	     |nalidade ao inves do codigo.		        ³±±
±±|Leandro Dr. |05/09/2012|TFSEDN    |Ajuste na impressao de fotos gravadas no  ³±±
±±|            |          | 	     |repositorio SQL.            		        ³±±
±±|Gustavo M.  |17/12/2012|31787/2012|Ajuste para imprimir contr. assistencial  ³±±
±±|            |          |          |ID 069.                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
USER Function PTGPR460()      
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis Locais (Basicas)                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
LOCAL cDesc1	:=	STR0001						//"Ficha de Registro"
LOCAL cDesc2 	:=	STR0002						//"Ser  impresso de acordo com os parametros solicitados pelo"
LOCAL cDesc3 	:=	STR0003						//"usuario."                                                          o
LOCAL cString	:=	"SRA"						// alias do arquivo principal (Base)
LOCAL aOrd 		:=	{STR0004,STR0005,STR0006}	//"Matricula"###"Centro de Custo"###"Nome"
LOCAL wnRel         
Local aArea		:= GetArea()
Local n

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis Utilizadas para Filtro                             ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Private cFiltraSRA				//Variavel para filtro
Private aIndexSRA	:= {}		//Variavel Para Filtro
Private bFiltraBrw  := {|| Nil}	//Variavel para Filtro

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis PRIVATE(Basicas)                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
PRIVATE aReturn := { STR0007, 1,STR0008, 2, 2, 1, "",1 }  //"Zebrado"###"Administra‡„o"
PRIVATE nomeprog:="GpeR460"
PRIVATE aLinha  := { },nLastKey := 0
PRIVATE cPerg   :="GPR460"
Private nChar	:= 18
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis Utilizadas na funcao IMPR                          ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
PRIVATE Titulo  := STR0009  //"FICHA DE REGISTRO"
PRIVATE cCabec
PRIVATE AT_PRG  := "GPER460"
PRIVATE wCabec0 := 9
PRIVATE wCabec1:=""
PRIVATE wCabec2:=""
PRIVATE wCabec3:=""
PRIVATE wCabec4:=""
PRIVATE wCabec5:=""
PRIVATE wCabec6:=""
PRIVATE wCabec7:=""
PRIVATE wCabec8:=""
PRIVATE wCabec9:=""
PRIVATE CONTFL:=1
PRIVATE LI:=0
PRIVATE nTamanho:="P"
PRIVATE cPathPict	:= ""
Private lImpDIni	:= .T.
Private lImpDFim	:= .T.
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis PRIVATE(Programa)                           ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
PRIVATE cIndCond
PRIVATE cFor
PRIVATE nOrdem
PRIVATE aInfo	:=	{}

Private oPrint , i:= 1
Private oTamFont,oFont07,oFont08,oFont08n,oFont08C, oFont10, oFont15, oFont10n, oFont21, oFont12,oFont12n,oFont16
Private nLin := nLinha:= 0, nColuna := 50
Private aCampo:= {}
Private nlinMax	:= 3040
Private nColMax := 2350
Private nColBox := 2200
Private lFirst	:= .T.
Private aFotos	:= {}			//armazena nome  foto 

Private nTipFicha := 1
Private lNewProf  := SuperGetMv("MV_NCPROF",,"2") == "1" // 1-Novo calculo da folha de professores; 2-Calculo antigo da folha de professores

Default _cRepDb	:= GetSrvProfString("RepositInDataBase","")
Default _cRep	:= SuperGetMv("MV_REPOSIT",.F.,"1")
Default _lRepDb	:= ( _cRepDb == "1" .And. _cRep == "2" )

Alert(" Relatorio Customizado pela Potencial / Report Custom by Potencial ")

//--Altera o Set Epch para 1920
nEpoca := SET( 5,1920)

// Criacao da funcao AjustaSX3 para atualizacao do Inic. Padrao para permitir impressao
// da descricao do cargo (RA_DCARGO) de uma filial a qual o usuario nao esteja logado.
// Inclusao de mesmo tratamento para o NOME DO SINDICATO.
AjustaSx3()

AjustaSx1() // Inclusao de pergunte

/*/
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ No Brasil, se o Modulo SIGAORG NAO ESTIVER em uso, os campos RA_DEPTO e  ³
³ RA_DDEPTO nao devem ser utilizados nesta rotina.						   ³
³ Portanto foi criada a funcao AJSX3DPT() no GPEA010 para ajustar o X3	   ³
³ destes campos em separado dos demais ajustes.							   ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
AJSX3DPT()

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Verifica as perguntas selecionadas                           ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Pergunte("GPR460",.F.)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para parametros                         					³
//³ mv_par01        //  Filial  De                              				 	³
//³ mv_par02        //  Filial  Ate                             			 		³
//³ mv_par03        //  Centro de Custo De                      			 		³
//³ mv_par04        //  Centro de Custo Ate                    				  		³
//³ mv_par05        //  Matricula De                             					³
//³ mv_par06        //  Matricula Ate                            					³
//³ mv_par07        //  Nome De                                  					³
//³ mv_par08        //  Nome Ate                                 					³
//³ mv_par09        //  Situacao                                 					³
//³ mv_par10        //  Categoria                                					³
//³ mv_par11        //  Ficha Atualizada                        					³
//³ mv_par12        //  Alt. Salariais                           					³
//³ mv_par13        //  Afastamentos                             					³
//³ mv_par14        //  Dependentes                              					³
//³ mv_par15        //  Ferias                                   					³
//³ mv_par16        //  Alt. Cadastrais                          					³
//³ mv_par17        //  Contrib. Sindicais                       					³
//³ mv_par18        //  Transferencias                           					³
//³ mv_par19        //  Beneficiarios                            					³
//³ mv_par20        //  Impr.Desc. Filial                        					³
//³ mv_par21        //  Impressao Grafica                        					³
//³ mv_par22        //  Data inicio de impressao                				    ³
//³ mv_par23        //  Data final de impressao                  					³
//³ mv_par24        //  Nome Responsavel Legal                   					³
//³ mv_par25        //  Imprime Tarefas( Fixas/Variaveis/Ambas)                     ³
//³ mv_par26        //  Prof./Tarefeiros Imprime(Historico Salarial/Tarefas/Ambos)  ³
//³ mv_par27        //  Titulo Relatorio: 											³
//³						  	   1-Ficha de Registro  	  							³
//³                       	   2-Ficha de Anotacoes e Atualizacoes da CTPS e PREVID.³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Envia controle para a funcao SETPRINT                        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
wnrel:="GPER460"            //Nome Default do relatorio em Disco
wnrel:=SetPrint(cString,wnrel,cPerg,@Titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,,nTamanho)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Ordem do Relatorio                                           ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
nOrdem   := aReturn[8]

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Carregando variaveis mv_par?? para Variaveis do Sistema.     ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
FilialDe	:= mv_par01
FilialAte	:= mv_par02
CcDe     	:= mv_par03
CcAte    	:= mv_par04
MatDe    	:= mv_par05
MatAte   	:= mv_par06
NomDe    	:= mv_par07
NomAte   	:= mv_par08
cSit     	:= mv_par09
cCat     	:= mv_par10
nFicha   	:= mv_par11
nSalar   	:= mv_par12
nAfast   	:= mv_par13
nDepen   	:= mv_par14
nFerias  	:= mv_par15
nAltcad	 	:= mv_par16
nConSin	 	:= mv_par17		
nTransf		:= mv_par18
nBenefic	:= mv_par19
nFilial		:= mv_par20
nGrafica	:= mv_par21
dDataIni	:= mv_par22
dDataFin	:= mv_par23
cResponsavel:= mv_par24
uTarefa		:= mv_par25
nImpSalTar	:= mv_par26
nTitulo 	:= mv_par27
nContAss 	:= mv_par28
nTipFicha 	:= nTitulo

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ¿
//³Ajustada flag para tratar como altera := .t., pois o inicializador de campo     ³
//³X3_RELACAO usa INCLUI para buscar a descrição do campo quando "V"irtual.        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ Ù
INCLUI := .F.
ALTERA := .T.

cFiltraRh 	:= CHKRH("GPEA260","SRA","1")
bFiltraBrw 	:= {|| FilBrowse("SRA",@aIndexSRA,@cFiltraRH) }

If nLastKey = 27
	Eval(bFiltraBrw)
	Return
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³Verifica preenchimento dos campos datas³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If Empty( dDataIni )
	lImpDIni:= .F.
	dDataIni := CTOD( "01/01/1900", "DDMMYYYY" )
Endif
If Empty( dDataFin )
	lImpDFim:= .F.
	dDataFin := CTOD( "31/12/2099", "DDMMYYYY" )
Endif
dDataFin := Max( dDataFin, dDataIni )

If !(mv_par21 = 1) 
	SetDefault(aReturn,cString)
EndIf	

If nLastKey = 27
	Eval(bFiltraBrw)
	Return
Endif                  	
If nGrafica ==1
	oPrint:=TMSPrinter():New(STR0001) 
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Verifica se ha impressora ativa conectada ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If ! oPrint:IsPrinterActive() 
		oPrint:Setup()							//-- Escolhe a impressora	
		If ! oPrint:IsPrinterActive()	
			Help(" ",1,"NOPRINTGRA")			//-- Nao foi encontrada configuracao de impressora. ##Certifique-se de que as configurações da impressora estão corretas ou se há alguma impressora conectada.
			Return(Nil)
		Endif
	Endif   
	If aReturn[4] == 2
		oPrint:SetLandscape()		//Modo Paisagem 
		nlinMax	:= 2400
	Else	
		oPrint:SetPortrait()		//Modo retrato 
	EndIf	
	oPrint:StartPage() 			//Inicia uma nova pagina 

	oFont07	:= TFont():New("Courier New",07,07,,.F.,,,,.T.,.F.) 
	oFont08n:= TFont():New("Arial",08,08,,.T.,,,,.T.,.F.)  
	oFont08c:= TFont():New("Courier New",08,08,,.F.,,,,.T.,.F.) 
	oFont08 := TFont():New("Arial",08,08,,.F.,,,,.T.,.F.) 
	oFont10	:= TFont():New("Courier New",10,10,,.F.,,,,.T.,.F.) 
	oFont10n:= TFont():New("Courier New",10,10,,.T.,,,,.T.,.F.) 
	oFont12	:= TFont():New("Arial",12,12,,.F.,,,,.T.,.F.) 
	oFont12n:= TFont():New("Arial",12,12,,.T.,,,,.T.,.F.)			//Negrito
	oFont15	:= TFont():New("Courier New",15,15,,.F.,,,,.T.,.F.) 
	oFont21 := TFont():New("Courier New",21,21,,.F.,,,,.T.,.T.) 
	oFont16	:= TFont():New("Arial",16,16,,.T.,,,,.T.,.F.) 
Endif 

//Titulo := STR0009  //"FICHA DE REGISTRO"

Titulo  := If (nTitulo== 1, STR0009, STR0100) //"FICHA DE REGISTRO", "FICHA DE ANOTACOES E ATUALIZACOES DA C.T.P.S."

RptStatus({|lEnd| GR460Imp(@lEnd,wnRel,cString)},Titulo)

If nGrafica == 1 
	oPrint:Preview()  		// Visualiza antes de imprimir

	//-- Apaga BMP Foto do Diretorio
	For n:=1 to Len(aFotos)
		IF File(aFotos[n])
			fErase( aFotos[n])
		Endif	
	next n	
Endif

//--Retornar Set Epoch Padrao
SET(5,nEpoca)
/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Restaura Area e Ordem de Entrada                              ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
RestArea( aArea)
Eval(bFiltraBrw)

Return 

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GPR460Imp³ Autor ³ R.H. - Ze Maria       ³ Data ³ 03.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Folha de Pagamanto                                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ GPR460Imp(lEnd,wnRel,cString)                              ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ lEnd        - A‡Æo do Codelock                             ³±±
±±³          ³ wnRel       - T¡tulo do relat¢rio                          ³±±
±±³          ³ cString     - Mensagem                                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function GR460Imp(lEnd,WnRel,cString)
Local cAcessaSRA  := &("{ || " + ChkRH("GPER460","SRA","2") + "}")
Local nLinhas	:= 0      
Local cFilter   := aReturn[7] // #

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Variaveis Locais (Basicas)                            ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Private	lImpressao	:= .F.  				//-- Define se houve impressao da informacao 

dbSelectArea( "SRA" )
dbGoTop()

If nOrdem == 1
	dbSetOrder(1)
	dbSeek(FilialDe + MatDe,.T.)
	cInicio  := "SRA->RA_FILIAL + SRA->RA_MAT"
	cFim     := FilialAte + MatAte
ElseIf nOrdem == 2
	dbSetOrder(2)
	dbSeek(FilialDe + CcDe + MatDe,.T.)
	cInicio  := "SRA->RA_FILIAL + SRA->RA_CC + SRA->RA_MAT"
	cFim     := FilialAte + CcAte + MatAte
ElseIf nOrdem == 3
	dbSetOrder(3)
	dbSeek(FilialDe + NomDe + MatDe,.T.)
	cInicio  := "SRA->RA_FILIAL + SRA->RA_NOME + SRA->RA_MAT"
	cFim     := FilialAte + NomAte + MatAte
Endif

SetRegua(SRA->(RecCount()))
                                                 	
cFilAnterior 	:= Space(FWGETTAMFILIAL)
cCcAnt       	:= Space(09)


dbSelectArea( "SRA" )
While !EOF() .And. &cInicio <= cFim
	
	IncRegua()

    If lEnd
        @Prow()+1,0 PSAY cCancel
        Exit
    Endif
    //ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
    //³ Consiste Parametrizacao do Intervalo de Impressao            ³
    //ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
    If (SRA->RA_NOME < NomDe) .Or. (SRA->RA_NOME > NomAte) .Or. ;
        (SRA->RA_MAT < MatDe)  .Or. (SRA->RA_MAT > MatAte)  .Or. ;
        (SRA->RA_CC < CcDe)    .Or. (SRA->RA_CC > CcAte)
		dbSelectArea( "SRA" )
		dbSkip()
		Loop
    Endif

    If  !(Sra->Ra_SitFolh $ cSit) .Or. !(Sra->Ra_CatFunc $ cCat)
		dbSelectArea( "SRA" )
		dbSkip()
		Loop
    Endif

	// #
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Consiste Filtro da setprint						             ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If ! Empty(cFilter) .And. ! &(cFilter)
		dbSelectArea("SRA")
		dbSkip()
		Loop
	EndIf

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Consiste controle de acessos e filiais validas               ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If !(SRA->RA_FILIAL $ fValidFil()) .Or. !Eval(cAcessaSRA)
		dbSelectArea( "SRA" )
		dbSkip()
		Loop
	EndIf

    IF  SRA->RA_FILIAL # cFilAnterior
        If ! fInfo(@aInfo,Sra->ra_Filial)
			Exit
		Endif
	Endif

	wCabec1 :=  aInfo[3]												//Razao Social
	wCabec2	:=  STR0011 + aInfo[1]  									//Filial
	wCabec3 :=  alltrim(aInfo[4]) + " - " + If(len( AllTrim( ainfo[14] ) ) > 0  , AllTrim( aInfo[14] ) + " - " + AllTrim( aInfo[13] ), AllTrim( aInfo[13] ) )   // Endereco + Complemento + Bairro
	If nGrafica  == 1 
		wCabec0	:= 9
   		wCabec4 :=  alltrim(aInfo[5]) + " - " + aInfo[6] 	
		wCabec5	:=  STR0031  + Transform(aInfo[7],"@R #####-###")          //CEP
		wCabec6 :=  STR0032  + Transform(aInfo[8],"@R ##.###.###/####-##") //CGC
		wCabec7	:=  STR0033  + aInfo[16]									//CNAE
		wCabec8	:=  STR0034  + aInfo[19]	 								//Cod.Munic.:"

	Else           
		wCabec0	:= 6
		wCabec4 :=  aInfo[5] + " - " + aInfo[6] + space(3)+ STR0031 + Transform(aInfo[7],"@R #####-###") 					//Municipio / Estado 
		wCabec5 :=  STR0032  + Transform(aInfo[8],"@R 99.999.999/9999-99")+space(5) + STR0033  + aInfo[16]+space(5)+STR0034  + aInfo[19] //CGC
		WCabec6	:=  STR0004  + "  " +SRA->RA_FICHA + " "+ SRA->RA_MAT + " - " + SRA->RA_NOME
	Endif

	nLin := 0	
	li	 := 0	
	lImpressao 	:= .F.  
	If nFicha == 1
		fImpFch()
	Endif
	
	If nSalar == 1
		fImpSal()
	Endif       
	
	If nAfast == 1 .Or. nAfast == 3
		fImpAfas()
	Endif       
	
	If nferias == 1
		fImpFer()
	Endif
	
	If nAltcad == 1
		fImpCad()
	Endif

	If nDepen == 1
		fImpDep()
	Endif     
	
	If nBenefic == 1
		fImpBen()
	Endif     

	If nConSin == 1 .or. nContAss == 1
		fImpSin()
	Endif    
    
	If nTransf == 1
		fImpTra()
	Endif  

	If lImpressao 
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Periodo de impressao                                        ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		fImpPeriodo() 
	
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Assinaturas                                                  ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		fAssinaBox() 
	Endif	

	aCampo 	:= {}      	
	lFirst	:= .T. 
	dbSelectarea("SRA")
	dbSkip()
Enddo         
If(nGrafica ==2,IMPR("","F"),oPrint:EndPage())

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Termino do relatorio                                         ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
dbSelectArea("SRA")
If Type("cFiltraRH") == "U" .Or. Empty(cFiltraRH)
Set Filter to
EndIf
dbSetOrder(1)
dbGoTop()

Set Device To Screen
If aReturn[5] = 1  .and. nGrafica # 1 
	Set Printer To
	Commit
	ourspool(wnrel)
Endif
MS_FLUSH()

Return
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpFch  ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao Ficha Atualizada                                 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpFch()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpfch()
Local aArea		:= GetArea()

Local cCabCpo,cCampo,cFolder,cOrdem
LOCAL cOrgCfg	:= GetMv("MV_ORGCFG", NIL, "0")	
Private	nPosT

cDet    := " "
dbSelectArea("SX3")
dbSetOrder(1)
dbSeek("SRA")
While ( !Eof() .And. SX3->X3_ARQUIVO == "SRA" )

	uCampo := SX3->X3_CAMPO
	
	If Alltrim(uCampo) $ 'RA_FILIALxRA_MATxRA_NOMEXRA_BITMAPXRA_FICHA'
		dbSelectArea("SX3")
		dbSkip()
		Loop
	Endif	
	
	// No Brasil, se o Modulo SIGAORG nao estiver em uso nao
	// permitir a utilizacao dos campos RA_DEPTO e RA_DDEPTO
	If cPaisLoc == "BRA" .and. cOrgCfg == "0" .and. Alltrim( uCampo ) $ 'RA_DEPTO/RA_DDEPTO'
		SX3->(dbSkip())
		loop
	Endif

	nPosT := Ascan(aDicioT,{|X| Subs(X,36,10) == uCampo })
	
	If nPosT <> 0 .And. Subs(aDicioT[nPosT],29,1) == 'X'
		IF ( SX3->X3_CONTEXT == "V" )
			cCampo := CriaVar(SX3->X3_CAMPO)
		Else                                      
			cCampo 	:= SRA->( FieldGet(FieldPos(uCampo)) )  
			If alltrim(ucampo) == "RA_SEXO"
				cCampo	:= fDescSexo( cCampo)
			ElseIf alltrim(ucampo) == "RA_TPCONTR"
				cCampo 	:= If (!Empty( cCampo), If(cCampo = "1",STR0066, STR0067),"")
 			ElseIf alltrim(ucampo) == "RA_RACACOR"
				If cCampo =="1"
					cCampo	:= STR0068			//-- Indigena 
				elseIf cCampo=="2"
					cCampo := STR0069 			//-- Branca
				elseif cCampo = "4"
					cCampo := STR0070			//-- Negra
				elseif cCampo = "6"
					cCampo := STR0071			//-- Amarela
				elseif cCampo = "8"
					cCampo := STR0072			//-- Parda 
				elseif cCampo = "9"
					cCampo := STR0073 			//-- Nao Informado
				Endif
			ElseIf alltrim(uCampo) == "RA_DEFIFIS"
				cCampo	:= If(cCampo == "1",STR0074, STR0075) 
			ElseIf alltrim(uCampo) == "RA_ESTCIVI" 
				cCampo := Substr(fDesc("SX5","33"+cCampo,"X5DESCRI()"),1,12)      
			ElseIf alltrim(uCampo) == "RA_TPDEFFI"
				Do Case                
					Case cCampo == "0"
						cCampo := STR0101		//Nenhuma
					Case cCampo == "1"
						cCampo := STR0102       //Fisica
			   		Case cCampo == "2"
				   		cCampo := STR0103		//Auditiva	
					Case cCampo == "3"
				   		cCampo := STR0104		//Visual
					Case cCampo == "4"
						cCampo := STR0105		//Mental
					Case cCampo == "5"			
				   		cCampo := STR0106		//Multipla
					Case cCampo == "6"
				   		cCampo := STR0107		//Reabilitado
					Otherwise
						cCampo := ""
				EndCase
			ElseIf alltrim(uCampo) == "RA_NACIONA" 
				cCampo := Substr( fDesc( "SX5", "34" + cCampo, "X5DESCRI()" ), 1, 25 )   
			//Else
			//	cCampo := SRA->( FieldGet(FieldPos(uCampo)) )
			EndIf
        Endif

		If ValType(cCampo) = "D"
			cCampo := Dtoc(cCampo)
		Elseif ValType(cCampo) = "N"
			cPict := "@E "+Replicate("9",Val(Subs(aDicioT[nPosT],49,3)) )
			If Val(Subs(aDicioT[nPosT],52,2)) > 0
				cPict += "."+Replicate("9",Val(Subs(aDicioT[nPosT],52,2)) )
			Endif
			cCampo := Transform(cCampo,cPict)
		ElseIf ValType(cCampo)="L"
			If cCampo	:= .F.
				cCampo 	:= "F"
			Else
				cCampo	:= "T"
			Endif
		Endif
		cCabCpo := fTacento(AllTrim(Subs(aDicioT[nPosT],1,12)))
		cFolder := subs(aDicioT[nPosT],54,2) 
		cOrdem  := subs(aDicioT[nPosT],56,3)
		aAdd(aCampo,{cCabCpo,cCampo,cFolder,cOrdem,SX3->X3_TIPO})
	Endif		
	dbSelectArea("SX3")
	dbSkip()
EndDo  
aSort( aCampo,,,{ |x,y| x[3]+x[4] < y[3]+y[4] } )	
                 
If Len(aCampo) > 0 
	If nGrafica == 1 
		fImpGraf(aCampo)
	Else
		fImpNorm(aCampo)
	Endif		
	lImpressao	:= .T.
Endif

RestArea( aArea)
//--SET CENTURY OFF
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpSal  ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao Alteracao Salarial                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpSal()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpSal()
Local aArea		:= GetArea()
Local aSal	    := {}
Local aTar	    := {}
Local cChaveSort:= ""
Local cMotivo	:= ""
Local nPosTp	:= SRO->( FieldPos( "RO_TPALT"	) )
Local lImpSal	:= .T.

If lNewProf
	lNewProf := nPosTp > 0 // So valida se o campo RO_TPALT estiver cadastrado
EndIf

//-- Professores e Tarefeiros
If SRA->RA_CATFUNC $ "I#J#T" .and. (nImpSalTar== 2 .or. nImpSalTar== 3)
	dbSelectArea("SRO")
	dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
	While SRO->( !EOF()) .And. SRO->RO_FILIAL+SRO->RO_MAT == SRA->RA_FILIAL+SRA->RA_MAT 
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Verifica periodo de impressao³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If SRO->RO_DATA < dDataIni .or. If(!empty(SRO->RO_DATAATE),SRO->RO_DATAATE > dDataFin,.F.)
			SRO->(dbSkip())
			Loop
		Endif
		
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Filtra tipos de tarefas      ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If SRA->RA_CATFUNC $ "I#J"
			If cPaisLoc == "BRA"
				If !( SRO->RO_TIPO $ uTarefa )
					SRO->(dbSkip())
					Loop
				EndIf
			Else
				If ( uTarefa == 1 .And. SRO->RO_TIPO # "1" ) .Or. ( uTarefa == 2 .And. SRO->RO_TIPO # "2" )
					SRO->(dbSkip())
					Loop
				EndIf
			EndIf
		Endif
		 
		If SRO->RO_QUANT == 0
			SRO->(dbSkip())
			Loop
		Endif
		/*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Cabecalho tabela               ³ 
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		If Len(aSal) = 0 .And. Len(aTar) = 0
			If nGrafica == 1 .or. !(SRA->RA_CATFUNC $ "I#J")
				//---*** Professor ***---
				//" Tp. Tarefa  Data De    Data Ate   Tarefa                   Aulas Semana Qtde. Tarefa   Valor Unitario      Valor Total 
				//  xxxxxxxx    99/99/9999 99/99/9999 999-XXXXXXXXXXXXXXXXXXXX   999,999.99 9,999,999.99 999,999,999.9999 999,999,999.9999 
				Aadd(aTar ,{STR0086,STR0087,STR0088,STR0089,STR0090,STR0091,STR0092,STR0093,""}) //STR0094,STR0095
			Else
						//  Data De |Data Ate|Tarefa        |Aul/Sem.|Q.Tar.|  Vl. Unitario|     Vl Total
				Aadd(aTar ,{STR0086,STR0087,STR0088,STR0089,STR0096,STR0097,STR0098,STR0093,""}) //STR0094,STR0095
			EndIf
		Endif
		cChaveSort := DTOS(SRO->RO_DATA)+StrZero(SRO->RO_VALOR,15)+StrZero(SRO->(Recno()),15) + "0"
        //cTipoTar := If( SRO->RO_TIPO == "1","Fixa","Variavel")
        
        If SRO->RO_TIPO == "1"
        	cTipoTar := OemtoAnsi(STR0114)	//"Fixa"
        ElseIf SRO->RO_TIPO  == "2"
        	cTipoTar := OemtoAnsi(STR0115)	//"Variavel"
        ElseIf SRO->RO_TIPO  == "3"
        	cTipoTar := OemtoAnsi(STR0116)	//"Adit. Fixo"
        ElseIf SRO->RO_TIPO  == "4"
        	cTipoTar := OemtoAnsi(STR0117) 	//"Adit. Var."
        EndIf
		
		If nGrafica == 1 .or. !(SRA->RA_CATFUNC $ "I#J")
			Aadd(aTar,{cTipoTar,DTOC(SRO->RO_DATA),DTOC(SRO->RO_DATAATE),SRO->RO_CODTAR+"-"+U_PTfDescTarefa(SRO->RO_CODTAR),Transform(SRO->RO_QTDSEM,"@E 9,999,999.99"),Transform(SRO->RO_QUANT,"@E 9,999,999.99"),Transform(SRO->RO_VALOR,"@E 99,999,999.99"),Transform(SRO->RO_VALTOT,"@E 99,999,999.99"),cChaveSort })
   		Else
			Aadd(aTar,{cTipoTar,DTOC(SRO->RO_DATA),DTOC(SRO->RO_DATAATE),SRO->RO_CODTAR+"-"+U_PTfDescTarefa(SRO->RO_CODTAR),Transform(SRO->RO_QTDSEM,"@E 999.99"),Transform(SRO->RO_QUANT,"@E 999.99"),Transform(SRO->RO_VALOR,"@E 99,999,999.99"),Transform(SRO->RO_VALTOT,"@E 99,999,999.99"),cChaveSort })
		EndIf
		
		// Impressao do motivo da alteracao da tarefa
		If lNewProf .And. SRA->RA_CATFUNC $ "I*J" .And. !Empty(SRO->RO_TPALT)
		
			dbSelectArea( "SX5" )
			If dbSeek( xFilial( "SX5" ) + "41" + SRO->RO_TPALT )
				cMotivo := fTAcento( SubStr(X5Descri(),1,31) )						
			Endif

			If !Empty(cMotivo)
				Aadd(aTar,{"","","",STR0119+cMotivo,"","","","",Soma1(cChaveSort)})
			EndIf

			dbSelectArea("SRO")
		EndIf

		SRO->( dbSkip() )
	EndDo
EndIf
          
lImpSal := .T.
                                                                           
lImpSal := If ( SRA->RA_CATFUNC $ "I#J#T" .and. nImpSalTar== 2 ,.F., lImpSal)

If lImpSal
	dbSelectArea("SR7")               
	DbSetOrder(1)
	dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
	While SR7->( !EOF()) .And. SRA->RA_FILIAL+SRA->RA_MAT = SR7->R7_FILIAL+SR7->R7_MAT
	
		nVez := 0
	    dbSelectArea("SR3")
		DbSetOrder(1)
	    dBseek(SR7->R7_FILIAL+SR7->R7_MAT+DTOS(SR7->R7_DATA)+SR7->R7_TIPO)
	    While SR3->( !EOF()) .And. SRA->RA_FILIAL+SRA->RA_MAT = SR3->R3_FILIAL+SR3->R3_MAT .And. ;
	                  SR3->R3_DATA = SR7->R7_DATA .And. SR7->R7_TIPO = SR3->R3_TIPO
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Verifica periodo de impressao³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If SR3->R3_DATA < dDataIni .or. SR3->R3_DATA > dDataFin
				dbSkip()
				Loop
			Endif
	
			/*
			ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			³ Cabecalho tabela               ³ 
			ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
			If Len(aSal) = 0
				If SR7->( Type("R7_DESCCAR") ) # "U"
					Aadd(aSal ,{STR0013,STR0014,STR0016,STR0053,STR0054,STR0055,STR0035,STR0063, "" }) 	//###"Desc.Cargo"
				Else
					Aadd(aSal ,{STR0013,STR0014,STR0016,STR0053,STR0054,STR0055,STR0035,"", "" })
				EndIf	
				//" Data        Desc.Aumento            Cat.   Pgto.      Verba                          Valor    Funcao" 
				//  99/99/9999  xxxxxxxxxxxxxxxxxxxx     x      x         xxxxxxxxxxxxxxxxxxxx   99.999.999,99    xxxxxxxxxxxxxx
			Endif
			
			dbSelectArea("SX5")
			dbSeek(xFilial("SX5")+"41"+SR7->R7_TIPO)
			If ! eof()
				cDescS := fTAcento(SUBS(X5Descri(),1,20))
			Else 
				cDescS := STR0017  //"Nao Cad. Tabela(41) "
			Endif
			dbSelectArea("SR3")
			cChaveSort := DTOS(SR7->R7_DATA)+StrZero(SR3->R3_VALOR,15)+StrZero(SR3->(Recno()),15) + "0"
			If nVez = 0
				If SR7->( Type("R7_DESCCAR") ) # "U"
					Aadd(aSal,{DTOC(SR7->R7_DATA),cDescS,SR7->R7_CATFUNC,SR7->R7_TIPOPGT,Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"),SR7->R7_DESCFUN,SR7->R7_DESCCAR,cChaveSort })
				Else	
					Aadd(aSal,{DTOC(SR7->R7_DATA),cDescS,SR7->R7_CATFUNC,SR7->R7_TIPOPGT,Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"),SR7->R7_DESCFUN,"",cChaveSort })
				EndIf
				nVez := 1
			Elseif nVez = 1
				nPosS := Len(aSal)
				If SR7->( Type("R7_DESCCAR") ) # "U"
					Aadd(aSal,{"","","","",Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"),SR7->R7_DESCFUN,SR7->R7_DESCCAR, cChaveSort })
				Else
					Aadd(aSal,{"","","","",Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"),SR7->R7_DESCFUN,"", cChaveSort })
				EndIf
				nVez := 2
			Else
				If SR7->( Type("R7_DESCCAR") ) # "U"
					Aadd(aSal,{"","","","",Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"), SR7->R7_DESCFUN,SR7->R7_DESCCAR, cChaveSort })
				Else
					Aadd(aSal,{"","","","",Subs(SR3->R3_DESCPD,1,20),Transform(SR3->R3_VALOR,"@E 99,999,999.99"), SR7->R7_DESCFUN,"", cChaveSort })
				EndIf
			Endif
			dbSkip()
		Enddo
		dbSelectArea("SR7")
		dbSkip()
	Enddo 
EndIf
If !empty(aSal) .and. Len(aSal) > 1

	aSort( aSal,,,{ |x,y| x[9] < y[9] } )
	If nGrafica == 1
		fImpSalG(aSal,"S")
	Else              
		fImpSalN(aSal,"S")	
	Endif
	lImpressao	:= .T. 
Endif

If !empty(aTar) .and. Len(aTar) > 1

	aSort( aTar,,,{ |x,y| x[9] < y[9] } )
	If nGrafica == 1
		fImpSalG(aTar,"T")
	Else              
		fImpSalN(aTar,"T")	
	Endif
	lImpressao	:= .T. 
Endif

RestArea( aArea)
Return


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpAfas ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ impressao de afastamentos                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpAfas()                                                 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpAfas()
Local aArea		:= GetArea()

Local aAfas := {}

dbSelectArea("SR8")
dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
While ! Eof() .And. SRA->RA_FILIAL+SRA->RA_MAT = SR8->R8_FILIAL+SR8->R8_MAT

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Verifica periodo de impressao³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If SR8->R8_DATAINI < dDataIni .or. SR8->R8_DATAINI > dDataFin
		dbSkip()
		Loop
	Endif

	If Len(aAfas) = 0
		Aadd(aAfas,{STR0013,STR0019,STR0020,STR0022})  //"|Data       Tipo                                   Data Inicio      Data Fim   "
	Endif
   	
	dbSelectArea("SX5")
	dbSeek(xFilial("SX5")+"30"+SR8->R8_TIPO)
	If ! eof()
		cDescA := fTacento(SUBS(X5Descri(),1,60))
	Else
       cDescA := STR0061
	Endif
	
	dbSelectArea("SR8")
	If nAfast != 3
		If SR8->R8_TIPO # "F"
			Aadd(aAfas,{DTOC(SR8->R8_DATA),alltrim(cDescA),DTOC(SR8->R8_DATAINI),DTOC(SR8->R8_DATAFIM) })
		EndIf                
	Else
		If SR8->R8_TIPO # "F" .And. (SR8->R8_DURACAO > 15 .Or. SR8->R8_TIPO $ "O|P|Q") 
			Aadd(aAfas,{DTOC(SR8->R8_DATA),alltrim(cDescA),DTOC(SR8->R8_DATAINI),DTOC(SR8->R8_DATAFIM) })
		EndIf                		
	EndIf
	dbSkip()
Enddo
If !Empty(aAfas) .and. Len(aAfas) > 1                      
	 If nGrafica ==1 
	 	fImpAfasG(aAfas)
	 Else    
	 	fImpAfasN(aAfas)
	 Endif
     lImpressao	:= .T.
Endif

RestArea( aArea)
Return
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpFer  ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ impressao de Ferias                                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpFer()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpFer()
Local aArea		:= GetArea()
Local aFerias := {}

dbSelectArea("SRH")
dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
While ! Eof() .And. SRA->RA_FILIAL+SRA->RA_MAT = SRH->RH_FILIAL+SRH->RH_MAT

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Verifica periodo de impressao³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If SRH->RH_DATAINI < dDataIni .or. SRH->RH_DATAINI > dDataFin
		dbSkip()
		Loop
	Endif

	If Len(aFerias) = 0
		Aadd(aFerias,{ STR0023,STR0056,STR0057,STR0058,STR0079,STR0080} )  //"|Periodo Aquisitivo   Periodo de Ferias       Data do Aviso    Data Pagto. D.Ferias d.Abono"
	Endif
	Aadd(aFerias,{DTOC(SRH->RH_DATABAS)+ " a "+DTOC(SRH->RH_DBASEAT), ;
		          DTOC(SRH->RH_DATAINI) +" a " +DTOC(SRH->RH_DATAFIM), ;
        		  DTOC(SRH->RH_DTAVISO) , DTOC(SRH->RH_DTRECIB)      , ;
        		  STRZERO(SRH->RH_DFERIAS,2), STRZERO(SRH->RH_DABONPE,2) })
	dbSkip()
Enddo                         

If !Empty(aFerias) .and. Len(aFerias) > 1 
	If nGrafica==1    
		fImpFeriaG(aFerias)
	Else     
		fImpFeriaN(aFerias)
	Endif		
	lImpressao	:= .T.
Endif	

RestArea( aArea)
Return 
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpCad  ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ impressao de Alt.Cadastrais                                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpCad()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpCad()
Local aArea		:= GetArea()

Local aAltCad := {}
cDet    := ""


dbSelectArea("SR9")
dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
While ! Eof() .And. SRA->RA_FILIAL+SRA->RA_MAT = SR9->R9_FILIAL+SR9->R9_MAT

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³Verifica periodo de impressao³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If SR9->R9_DATA < dDataIni .or. SR9->R9_DATA > dDataFin
		dbSkip()
		Loop
	Endif

	If Len(aAltCad) = 0
		Aadd(aAltCad,{ STR0013,STR0025,STR0059})  //"Data         Campo Alterado    Descricao"
	Endif
	nPos    := Ascan(aDicioT,{ |x| Subs(x,36,10)=SR9->R9_CAMPO })
	If nPos > 0
		cTitulo := fTAcento(Subs(aDicioT[nPos],1,12))
		Aadd(aAltCad,{DTOC(SR9->R9_DATA), cTitulo,SR9->R9_DESC	} )
	Endif
	dbSkip()
Enddo                                               
If !Empty(aAltCad) .and. Len(aAltCad) > 1
	If nGrafica ==1   
		fImpCadG(aAltCad)
	Else     
		fImpCadN(aAltCad)
	Endif		
	lImpressao	:= .T.
Endif

RestArea( aArea)
Return 
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpDep  ³ Autor ³ R.H. - Mauro          ³ Data ³ 04.06.96 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ impressao de Dependentes                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpDep()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpDep()
Local aArea		:= GetArea()

Local aDep := {}
Local m_sexo		:= ""
Local m_graupar 	:= ""
Local m_TipIR		:= ""
Local m_TipSF		:= ""

dbSelectArea("SRB")
dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
While ! Eof() .And. SRA->RA_FILIAL+SRA->RA_MAT = SRB->RB_FILIAL+SRB->RB_MAT
	If Len(aDep) = 0
		Aadd(aDep,{STR0027,STR0026,STR0037,STR0038,STR0040,STR0048,STR0050} )  //"|Cod|Dependente                     Dt.Nasc  Sexo Parent IR  S.F."
	Endif
    m_Sexo		:= fDescSexo(SRB->RB_SEXO)  
    
	//Correcao dos menus de opcoes RB_GRAUPAR
    If SRB->RB_GRAUPAR  == "F"
    	m_graupar	:=  STR0076		 //"Filho"
    ElseIf SRB->RB_GRAUPAR  == "C"
    	m_graupar 	:=  STR0077 	 //"Conjuge"
    ElseIf SRB->RB_GRAUPAR  == "P"
    	m_graupar 	:= STR0126		 //"Pai/Mae"
    ElseIf SRB->RB_GRAUPAR  == "E"
    	m_graupar 	:= STR0127	 	 //"Enteado" 
    Else
    	m_graupar 	:=  STR0078 	 //"Outros" 		
    EndIf          
    
    m_TipIR		:= If(SRB->RB_TIPIR =="4", STR0075, STR0074) 
    m_TipSF		:= If(SRB->RB_TIPSF =="3", STR0075, STR0074) 

	If ascan(aDep,{ |x| ( x[2] == SRB->RB_NOME .AND. x[3] == Dtoc(SRB->RB_DTNASC) ) } ) == 0
		Aadd(aDep,{SRB->RB_COD,SRB->RB_NOME,Dtoc(SRB->RB_DTNASC),M_SEXO,M_GRAUPAR,M_TIPIR,M_TIPSF })
	EndIf
	dbSkip()
Enddo
If !Empty(aDep) .and. Len(aDep) > 1
	If nGrafica==1
		fImpDepG(aDep)
	Else
		fImpDepN(aDep)
	Endif
	lImpressao	:= .T.
Endif

RestArea( aArea)
Return 
			

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpBen  ³ Autor ³ R.H. - Natie          ³ Data ³ 22.01.02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao de Beneficiarios                                 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpBen()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpBen()
Local aArea		:= GetArea()

Local aBenef := {}

dbSelectArea("SRQ")
dbSeek(SRA->RA_FILIAL+SRA->RA_MAT)
While ! Eof() .And. SRA->RA_FILIAL+SRA->RA_MAT = SRQ->RQ_FILIAL+SRQ->RQ_MAT
	If Len(aBenef) = 0
		Aadd(aBenef,{STR0027,STR0060} )  //"|Cod|Beneficiario                   
	Endif 
	If SRQ->RQ_ORDEM =="01"
		Aadd(aBenef,{SRQ->RQ_ORDEM,SRQ->RQ_NOME })
	Endif
	dbSkip()
Enddo
If !Empty(aBenef) .and. Len(aBenef) > 1
	If nGrafica==1
		fImpBenG(aBenef)
	Else
		fImpBenN(aBenef)
	Endif
	lImpressao	:= .T.
Endif

RestArea( aArea)
Return 

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpSin  ³ Autor ³ R.H. - Marinaldo      ³ Data ³09/05/2000³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao das Contribuicoes Sindicais                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpSin()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpSin()
Local aArea		:= GetArea()

Local aConSin	:=	{}
Local aConAss	:=	{}
Local aCodFol	:=	{}
Local aChave	:=	{}
Local aSindica	:=	{}
Local cChave	:=	""
Local cSindica	:=	""
Local cDescSin	:=	""
Local cSindAnt	:= ""
Local cDescAnt	:= ""

Local cDet		:=	""
Local nPos		:=	0
Local x			:=	0
Local dDataAux	:=	SRA->RA_ADMISSA
Local cDescACodFol	:= ""
Local lClasOutEmp 	:= .F.
nRecSRA			:= SRA->( Recno() )

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Carrega aCodFol                                              ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
IF !Fp_CodFol(@aCodFol,SRA->RA_FILIAL)
   Return(.F.)
EndIF

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Seleciona o Arquivo de Transferencias e Retorna Todas as Transferencias  ³
³do Funcionario (Nao Gravara Filial + Matricula  Iguais 7o. Parametro de  ³
³fTransf). Somente preenche com transf. de Empresa e Filial, params 3 e 4.³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
fTransf(@aChave,,.T.,.T.,,,.T.,.T.)

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Grava em aChave  a Situacao Atual do Funcionario              ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
IF aScan( aChave,{ |x| ( x[1] + x[2] ) == ( cEmpAnt + SRA->RA_FILIAL+SRA->RA_MAT ) } ) == 0
    	SRA->( aAdd(aChave,{									 ;
    						cEmpAnt								,; // 01 - Empresa Origem
    						RA_FILIAL+RA_MAT   					,; // 02 - Filial + Matricula Origem  
    						RA_CC								,; // 03 - Centro de Custo Origem
    						cEmpAnt								,; // 04 - Empresa Destino
    						RA_FILIAL+RA_MAT      				,; // 05 - Filial + Matricula Destino
    						RA_CC								,; // 06 - Centro de Custo Destino
							Nil									,; // 07 - Data da Transferencia
							RA_FILIAL							,; // 08 - Filial Origem
    						}									 ;
    				)											 ;
    		  )
Endif

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Verifica se Teve Alteracao de Sindicato                      ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
IF Len(aChave) > 0 
	For nPos := 1 To Len(aChave)
		cChave := aChave[nPos,2]
		IF SR9->( dbSeek( cChave + "RA_SINDICA" ,.T.) )
    		dbSelectArea('SR9')
			While SR9->( !Eof()  .and. R9_FILIAL+R9_MAT+R9_CAMPO == cChave + "RA_SINDICA" )
	        	/*
				ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
				³ Assume Sempre a Ultima Alteracao quando Feita no Mesmo Mes   ³
				ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	        	IF ( x := aScan( aSindica , { |y| MesAno( y[1] ) == MesAno( SR9->R9_DATA ) } ) ) > 0
	        		aSindica[x,1] := SR9->R9_DATA
	        	 	aSindica[x,2] := Subst(R9_DESC,1,2) 
					aSindica[x,3] := AllTrim( fDesc("RCE",Subst(SR9->R9_DESC,1,2),"RCE_DESCRI",40, SR9->R9_FILIAL ) )
	        	Else
	        		SR9->( aAdd( aSindica ,{ R9_DATA , Subst(R9_DESC,1,2),AllTrim( fDesc("RCE",Subst(R9_DESC,1,2),"RCE_DESCRI",40,R9_FILIAL))}))
  	   			EndIF
  	   			dbSelectArea('SR9')
  	   			dbSkip()
			EndDo
		EndIF
	Next nPos
EndIF

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Verifica Se houve Troca de Sindicato por transferencia de FILIAL.	³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
nRecSRA	:= SRA->( Recno() )
IF Len( aChave ) > 0
	For nPos := 1 To Len( aChave )
		If Len(aChave[nPos]) >= 8	// Se nao tiver todos os elementos, indica sindicato atual e nao processa neste bloco de codigo
			cSindica := Posicione("SRA",1,aChave[nPos,2],"RA_SINDICA")
			cDescSin := AllTrim( fDesc("RCE", cSindica, "RCE_DESCRI", 40, aChave[nPos,8]))
			IF ! Empty( aSindica ) .and. aChave[nPos,7] # Nil
				aAdd( aSindica , { aChave[nPos,7] , cSindica, cDescSin } )
			ElseIf aChave[nPos,7] # Nil
				aSindica := { { aChave[nPos,7], cSindica, cDescSin } }
			EndIf
		EndIf
	next nPos
EndIf
SRA->( DbGoTo( nRecSRA ) )

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Acrescenta o Sindicato Atual do Funcionario                  ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
IF !Empty(aSindica)
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³A Data Correspondente ao Sindicato Atual Deve ser Sempre Maior³
	³Que a ultima Alteracao de Sindicato.                          ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	aAdd( aSindica , { IF( dDataBase > aSindica[ Len(aSindica), 1 ] .or. aSindica[ Len(aSindica), 1 ] == Nil, dDataBase, ( aSindica[Len(aSindica),1] + 360 ) ),;
					   SRA->RA_SINDICA, AllTrim( fDesc("RCE",SRA->RA_SINDICA,"RCE_DESCRI",40,SRA->RA_FILIAL) ) } )
Else
	aSindica := { { dDataBase , SRA->RA_SINDICA, AllTrim( fDesc("RCE",SRA->RA_SINDICA,"RCE_DESCRI",40,SRA->RA_FILIAL) ) } }
EndIF
cSindica := aSindica[ Len(aSindica) , 2 ]
cDescSin := AllTrim( fDesc("RCE",SRA->RA_SINDICA,"RCE_DESCRI",40,SRA->RA_FILIAL))
/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Ordena as Alteracoes de Sindicato Ordem Crescente de Data    ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
aSort( aSindica,,,{ |x,y| x[1] < y[1] } )

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Preparando Dados Para a Impressao                            ³ 
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
dbSelectArea("SRD")
For nPos := 1 To Len(aChave)
	cChave	:=	aChave[nPos, 2]
	dbSeek(cChave)
	While SRD->( !Eof() .and. cChave = RD_FILIAL + RD_MAT )
		dDataAux	:=	SRA->RA_ADMISSA
  		lClasOutEmp 	:= .F.
  	    /*
  	    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ So Imprime verba de Contribuicao Sindical                    ³ 
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
       	IF !( SRD->RD_PD $ (  aCodFol[068,1] + '_' + aCodFol[246,1] + '_' + aCodFol[069,1] ) )  
       		SRD->( dbSkip() ) 
			Loop
	    /*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³Se a contrib.sindical foi efetuada em outra empresa, a descr. ³
		³do sindicato sera a mesma do ID 246                           ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		ElseIf SRD->RD_PD $ aCodFol[246,1] .or.  (! Empty(SRD->RD_EMPRESA) .And. SRD->RD_EMPRESA # cEmpAnt) 
			cDescACodFol	:= fDesc("SRV",aCodFol[246,1], "RV_DESC") 
			lClasOutEmp 	:= .T. 
   	    EndIF 
   	    /*
  	    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Verifica se a Verba pertence a empresa Atual                 ³ 
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		If 	cEmpAnt # aChave[nPos,1]
       		SRD->( dbSkip() ) 
        	Loop
   	    EndIF	

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Verifica periodo de impressao³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If SRD->RD_DATARQ < MesAno(dDataIni) .or. SRD->RD_DATARQ > MesAno(dDataFin)
			SRD->(dbSkip())
			Loop
		Endif
   	    
        /*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Cabecalho das Contribuicoes Sindicais                        ³ 
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		IF Len(aConSin) = 0
			Aadd(aConSin,{STR0013,STR0039 ,STR0055,STR0042,'H'} )	//"|Data        | Mes   | Valor            | Sindicato                     |"
        EndIF
		
		/*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Verifica se a Alteracao de Sindicato esta dentro do Periodo a³ 
		³ Ser Listado.                                                 ³ 
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		For x := 1 To Len( aSindica )
			IF SRD->RD_DATARQ >= MesAno( dDataAux ) .and. SRD->RD_DATARQ <= MesAno( aSindica[x,1] )
				If x # 1 .and. MesAno( aSindica[x,1] ) > MesAno( dDataAux ) .and. Year( aSindica[x,1] ) > Year( SRD->RD_DATPGT )
		    		cSindica := cSindAnt
					cDescSin := cDescAnt
				Else 
		    		cSindica := aSindica[x,2]
					cDescSin := aSindica[x,3]
				Endif
				Exit
		    EndIF 
	    	dDataAux	:= aSindica[x,1]
    		cSindAnt	:= aSindica[x,2]
	   	   	cDescAnt	:= aSindica[x,3]
		Next x 

		SRD->( Aadd(aConSin,{ DTOC(RD_DATPGT), Subst( RD_DATARQ , -2 ), Transform(RD_VALOR,"@E 999,999,999.99"), If(lClasOutEmp,cDescACodFol, cDescSin ) ,;
								IF( SRD->RD_PD $ ( aCodFol[069,1]), "A","S");
							} ))
							
		dbSelectArea("SRD")
		dbSkip()
	Enddo
Next nPos

If len(aConSin) > 1 
    
	aAux:=aClone(aConSin)  
        
    aConSin := {}
    aConAss := {}
	    
     aAdd(aConSin, aClone( aAux[1] ) ) 
     aAdd(aConAss, aClone( aAux[1] ) )	
	        
	Aeval(aAux,{|X| If(x[Len(X)] == "A", aAdd(aConAss, aClone(X) ), aAdd(aConSin, aClone(X)) )}, 2 )
	
	If nGrafica ==1 
		IF Len(aConSin) > 1 .and. nConSin == 1 
			fImpSindG(aConSin, STR0036)
		Endif         
		
		IF Len(aConAss) > 1 .and. nContAss == 1
			fImpSindG(aConAss, STR0125)
		Endif	
	Else   
	  	IF Len(aConSin) > 1 .and. nConSin == 1 
			fImpSindN(aConSin, STR0036)
		Endif         
		
		IF Len(aConAss) > 1 .and. nContAss == 1
			fImpSindN(aConAss, STR0125)
		Endif	
	Endif
	lImpressao	:= .T.
Endif

RestArea( aArea )
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ fImpTra  ³ Autor ³ R.H. - Marinaldo      ³ Data ³10/05/2000³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao das Transferencias                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ fImpTra()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static function fImpTra()
Local aArea		:= GetArea()

Local aTransf	:=	{}
Local aTraFE	:=	{}
Local cEmp		:=	""
Local cFil	 	:=	""
Local cCgc		:=	""
Local cDescEmp	:=	""
Local cDescFil	:=	""
Local cEndereco	:=	""
Local cBairro	:=	""
Local cCidade	:=	""
Local cEstado	:=	""
Local cTipEnd	:=	GetMv("MV_PAREND")
Local dDataTra	:=	Ctod('//')
Local nSvRecno	:=	SM0->( Recno () )
Local nTra		:=	0

nColuna	:= 050

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Seleciona o Arquivo de Transferencias e Retorna Todas as Trans³
³ferencias do Funcionario 									   ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
fTransf(@aTransf,,,,,,,.T.)
For nTra := 1 To Len(aTransf)
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³Carrega apenas as Transferencias Entre Filiais e Empresas     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	If aTransf[nTra,7] >= dDataIni .and. aTransf[nTra,7] <= dDataFin
		//IF !( aTransf[nTra,1] == aTransf[nTra,4] ) .or. !(Subst(aTransf[nTra,2],1,FwGetTamFilial) == Subst(aTransf[nTra,5],1,FwGetTamFilial) )
			aAdd(aTraFE,{aTransf[nTra,1] ,; // Empresa De
						aTransf[nTra,2] ,; // Filial + Matricula De
						aTransf[nTra,3] ,; // Centro de Custo De
						aTransf[nTra,4] ,; // Empresa Para
						aTransf[nTra,5] ,; // Filial + Matricula Para
						aTransf[nTra,6] ,; // Centro de Custo Para
						aTransf[nTra,7] ,; // Data da Transferencia
					     } )
		// EndIF
	Endif
Next nTra

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³Reinicializa aTransf                                          ³ 
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
aTransf := {}


/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Preparando Dados Para a Impressao                            ³ 
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
For nTra := 1 To Len(aTraFE)
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Cabecalho das Transferencias                                 ³ 
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	IF Len(aTransf) = 0
		Aadd(aTransf,{ " "   ,STR0043+" / CC Orirem ","" })	//"|            Empresa de Origem   "
		Aadd(aTransf,{STR0013,STR0045+" / CC Destino","" })	//"|Data        Empresa de Destino  "
    EndIf
    /*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Dados da Empresa de Origem                                   ³ 
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
   	cEmp		:= aTraFE[nTra,1]+aTraFE[nTra,3] 
    cFil		:= Subst(aTraFE[nTra,2],1,FWGETTAMFILIAL)
    SM0->( dbSeek(cEmp+cFil) )
    cDescEmp	:= ALLTRIM(SM0->M0_NOMECOM) + " / CC: "+Posicione("CTT",1,xFilial("CTT")+aTraFE[nTra,3],"CTT_DESC01") 
    cDescFil	:= SM0->( IF(nFilial == 1 , M0_NOME , M0_FILIAL ) )
	aAdd(aTransf,{"" , cEmp + "-" + cDescEmp  , cFil + " - " + cDescFil} )
	
	cCgc		:= SM0->(Transform(M0_CGC,'@R ##.###.###/####-##') )
	cEndereco	:= SM0->( IF( cTipEnd = "C", M0_ENDCOB , M0_ENDENT ) )
	
	aAdd(aTransf,{"" , IF(SM0->M0_TPINSC = 1 , STR0047 , STR0032 ) + cCgc + Space(01) + STR0049 + cEndereco," " } )//"CEI"###"CGC"###"End.: "

	cBairro		:=	SM0->( IF( cTipEnd = "C", M0_BAIRCOB, M0_BAIRENT ) )
	cCidade		:=	SM0->( IF( cTipEnd = "C", M0_CIDCOB	, M0_CIDENT  ) )
	cEstado		:=	SM0->( IF( cTipEnd = "C", M0_ESTCOB	, M0_ESTENT  ) )

	aAdd(aTransf,{"" ,STR0028 + cBairro + " -" + cCidade + Space(01) + STR0030 + cEstado," " } ) //"Bairro: "###"Cidade: "###"UF: "
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Dados da Empresa de Destino                                  ³ 
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	cEmp		:= if(Empty(aTraFE[nTra,4]),aTraFE[nTra,1]+aTraFE[nTra,6], aTraFE[nTra,4]+aTraFE[nTra,6])
	cFil		:= If(Empty(Subst(aTraFE[nTra,5],1,FWGETTAMFILIAL)),Subst(aTraFE[nTra,2],1,FWGETTAMFILIAL),Subst(aTraFE[nTra,5],1,FWGETTAMFILIAL))
	dDataTra	:= aTraFE[nTra,7]
	SM0->( dbSeek(cEmp+cFil) )
	cDescEmp	:= ALLTRIM(SM0->M0_NOMECOM)+ " / CC:  "+Posicione("CTT",1,xFilial("CTT")+aTraFE[nTra,6],"CTT_DESC01") 
	cDescFil	:= SM0->( IF(nFilial == 1 , M0_NOME , M0_FILIAL ) )
	aAdd(aTransf,{DTOC(dDataTra), cEmp + " - " + cDescEmp + space(7) , cFil + " - " + cDescFil } )

	cCgc		:= SM0->(Transform(M0_CGC,'@R ##.###.###/####-##') )  
	cEndereco	:= SM0->( IF( cTipEnd = "C", M0_ENDCOB , M0_ENDENT ) )
	
	aAdd(aTransf,{"" , IF(SM0->M0_TPINSC = 1 , STR0047 , STR0032 ) + cCgc + Space(01) + STR0049 + cEndereco," " })//"CEI"###"CGC"###"End.: "

	cBairro		:=	SM0->( IF( cTipEnd = "C", M0_BAIRCOB, M0_BAIRENT ) )
	cCidade		:=	SM0->( IF( cTipEnd = "C", M0_CIDCOB	, M0_CIDENT  ) )
	cEstado		:=	SM0->( IF( cTipEnd = "C", M0_ESTCOB	, M0_ESTENT  ) )

	aAdd(aTransf, {"" ,STR0028 + cBairro + " - " + cCidade + Space(01) + STR0030 + cEstado," " }) //"Bairro: "###"Cidade: "###"UF: "

	SM0->( dbGoto( nSvRecno ) )
Next nTra

If !Empty(aTransf) .and. Len(aTransf) > 2
	If  nGrafica==1
		fImpTraG(aTransf)
	Else     
		fImpTraN(aTransf)
	Endif
	lImpressao	:= .T.	
Endif
SM0->( dbGoto( nSvRecno ) )

RestArea( aArea)
Return


/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpGraf  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico - Ficha  Funcion.º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpGraf(aCampo)
Local cDet 		:= " ",Ix	:= 1
Local nTaman	:= nTam1	:=	nTam2	:= nTamTot	:= 0 
Local cDescFol	:= " "
Local nPosF
Local nCol		:= 0
Local nX		:= 0
Local nLinhas   := 0  
Local nIncLinha := 0
Local aCpoMemo  := {}
       
nLin 	:= 0 
nColuna	:= 050

ImprG(" " ,"C",,,nColuna,,nLin)

nAcampo 	:= Len(aCampo)
nColuna 	:= 050
While  .T.
	cFolder := aCampo[Ix,3]
	nPosF	:= Ascan(aAgrup,{|X| substr(x,10,2) = cFolder })
	cDescFol:= ""		
	cDescFol:=If(nPosF>0, substr(aAgrup[nPosF],12,20) , cDescFol )
	
	//-- Quebra do Agrupamento 
	If nlin >= nLinMax .or. (nLin + 150) >= nLinMax
		nLin  := 0    
		oPrint:EndPage() 		// Finaliza a pagina
		nColuna := 50
		ImprG(" ","C",,,nColuna,,nLin,oFont10)
	Endif                                          
	
	nLin += 40
	nCol	:= int( ( nColBox - ( Len(cDescFol) * 100 / 7) )) /2
	oPrint:Line(nLin,nColuna-20 ,nLin, nColMax)
	nLin += 25
	oPrint:say(nlin,nCol,cDescFol,oFont10n)
	nLin  += 40
	oPrint:Line(nLin,nColuna-20 ,nLin, nColMax)
	nLin += 40
	While Ix <= nACampo .and. cFolder = aCampo[Ix,3]
     
		nTam1	:= ( Len(aCampo[ix,1]) * 100)/ 8
		nTam2 	:= ( Len(aCampo[ix,2]) * 100)/ 5
		nTaman	:= If( nTam1 > nTam2,nTam1,nTam2)+ 120
    
		IF (nColuna+nTaman) >= nColMax
			nLin 	+= 100
			nColuna := 50
		Endif	
	
		If nlin >= nLinMax .or. (nLin  + 90) >= nLinMax
			nLin  := 0
			oPrint:EndPage() 		// Finaliza a pagina
			nColuna := 50
			ImprG(" ","C",,,nColuna,,nLin,oFont10)
		Endif
	
	    nTamTot	:= nColuna + nTaman 
	    If nTamTot > nColMax 
	    	nTamTot	:= nColMax - 10
	    Endif	
	    
		//Tratamento especifico para campos do tipo MEMO
		If (aCampo[ix,5] == 'M')  
			Q_MemoArray( aCampo[ix,2], aCpoMemo, 125)
			nLinhas := Len( aCpoMemo )
		EndIf
        
		//Impressao da borda campos diferentes do Tipo Memo
		If nLinhas < 1 
			oPrint:Line(nLin+020, nColuna, nLin+090, nColuna)	//1a vertical
			oPrint:Line(nLin+020, nTamTot, nLin+090, nTamTot) 	//2a vertical
			oPrint:Line(nLin+090, nColuna, nLin+090, nTamTot)	//horizontal 
		EndIf
        
		ImprG(aCampo[ix,1],"C",,,nColuna+10,.f.,nlin,oFont08n)	//Cabecalho campo

		If nLinhas > 0  
			nIncLinha := nLin + 20 //Guarda a posicao para impressao da coluna vertical
			For nX := 1 To nLinhas
				ImprG( aCpoMemo[nX],"C",,,nColuna,.f.,nLin+40,oFont10)	//Detalhe do campo tipo Memo
			Next nX  
		Else
			ImprG(aCampo[ix,2],"C",,,nColuna,.f.,nLin+40,oFont10)	//Detalhe do campo demais tipos	
		EndIf
		
		//Impressao da borda para campos Tipo Memo 
		If nLinhas > 0 
			nIncLinha := ( nLin - nIncLinha ) //Obtem a posicao inicial da coluna vertical
			oPrint:Line(nLin-nIncLinha, nColuna-10, nLin+50, nColuna-10) //1a vertical
			oPrint:Line(nLin-nIncLinha, nTamTot,    nLin+50, nTamTot) 	  //2a vertical
			oPrint:Line(nLin+50,        nColuna-10, nLin+50, nTamTot)	  //horizontal
		EndIf
		
		nLin 	-= 40
		nColuna	+= Int(nTaman)+ 40

		Ix ++
		If Ix > len(aCampo)
			nLin += 150
			oPrint:Line(nLin,050,nlin,nColMax)									//horizontal
			nLin += 050
			If nlin >= nLinMax
				nLin  := 0
				oPrint:EndPage() 		// Finaliza a pagina
				nColuna := 50
				ImprG(" ","C",,,nColuna,,nLin,oFont10)
			Endif
			Return
		Endif	
		aCpoMemo := {}
		nLinhas  := 0			
	Enddo
	nLin  	+= 100 
	nColuna	:= 050

	If nlin >= nLinMax
		nLin  := 0
		oPrint:EndPage() 		// Finaliza a pagina
		nColuna := 50
		ImprG(" ","C",,,nColuna,,nLin,oFont10)
	Endif
Enddo
Return                

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpNorm  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/

Static Function  fImpNorm(aCampo)
Local cDet 		:= " ",Ix	:= 1
Local nTaman	:= nTam1	:=	nTam2	:= 0 
Local cDescFol	:= " "
Local nPosF
Local nX 		:= 0 
Local nLinhas	:= 0 
Local aCpoMemo  := {}

nAcampo 	:= Len(aCampo)
Li 			:= 0 
Impr("","C",,,,,,,,.T.)


While  .T.
	cFolder := aCampo[Ix,3]
	nPosF	:= Ascan(aAgrup,{|X| substr(x,10,2) = cFolder })
	cDescFol:= ""	
	cDescFol:=If(nPosF>0, substr(aAgrup[nPosF],12,20) , cDescFol )
	
	//-- Quebra do Agrupamento 
	If li >= 60 .or. (Li + 10) > 60
		Impr(" ","P")
	Endif 
	//- Cabecalho Agrupamento    
	cDet	:= repl("-",78)
	nDet	:= (78-Len(alltrim(cDescFol)) ) /2
	Impr( cDet,"C",,,01)
	Impr( "|" ,"C",,,00,.f.)	     
	Impr(cDescFol ,"C",,,nDet,.f.)
	Impr( "|" ,"C",,,79)	     	
	Impr(cDet,"C",,,01)	
	cDet	:= ""		
	While cFolder = aCampo[Ix,3]
		If li >= 60 
			Impr(REPL("-",78),"C")
			Impr(" ","P")
		Endif
					
		If Len(cDet)+Len(aCampo[ix,2])+16 < 78
			cCabCpo := aCampo[ix,1]
			cDet 	+= cCabCpo+Replicate(".",12-Len(cCabCpo))+" :["+aCampo[ix,2]+"]"
			cDet 	+= Space(If (Len(cDet)+5 > 78,78-Len(cDet),5))
		Else
			If !Empty( cDet )
				Impr("|"+cDet+Space(78-Len(cDet))+"|","C")
			EndIf
			cCabCpo := aCampo[ix,1]
			                     
			//Tratamento especifico para campos do tipo MEMO			
			If (aCampo[ix,5] == 'M')
				Q_MemoArray( aCampo[ix,2], aCpoMemo, 63)
				nLinhas := Len( aCpoMemo ) 
				For nX := 1 To nLinhas
					If nX == 1
						cDet 	:= cCabCpo + Replicate(".",12-Len(cCabCpo)) + " :[" + AllTrim( aCpoMemo[nX] ) + If( nX==nLinhas, "]", "" )
						Impr("|" + cDet + Space(78-Len(cDet)) + "|" , "C")
						cDet     := ""
					Else			 
						cDet 	:= Space(15) + AllTrim( aCpoMemo[nX] )
						If nX == nLinhas         
							cDet 	:= Space(15) + AllTrim( aCpoMemo[nX] ) + "]"
						Else
							Impr("|" + cDet + Space(78-Len(cDet)) + "|" , "C")
							cDet     := ""						
						EndIf
					EndIf  
				Next nX   
				aCpoMemo := {}   
			Else
				cDet 	:= cCabCpo+Replicate(".",12-Len(cCabCpo))+" :["+aCampo[ix,2]+"]"
				cDet 	+= Space(If (Len(cDet)+5 > 78,78-Len(cDet),5))			
			EndIf
					
		Endif
		Ix ++
		If Ix > len(aCampo)
			Impr("|"+cDet+Space(78-Len(cDet))+"|","C")
			cDet	:= repl("-",78)
			Impr( cDet,"C",,,01)
			Return nil 
		Endif	
	Enddo
Enddo        
cDet	:= repl("-",78)
Impr(cDet,"C")

Li ++
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpSalG  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/

Static Function fImpSalG(aSal,cHist)
Local N     	:= 0
Local nLinhas	:= 0     
           
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Testa Quebra de Pagina                                       ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
fTestaQuebra(aSal,@nLinhas)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Box Detalhe                                                  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
fSalBox(nLinhas,cHist)
For N:=1 To Len(aSal)
	If nLin + 100 >= nLinMax

		fFimPag(aSal,N,@nLinhas) 
 			
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Box Detalhe                                                  ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		fSalBox(nLinhas,cHist)
		If SRA->RA_CATFUNC $ "I#J" .and. cHist == "T"
			ImprG(aSal[01,1],"C",,,0060,.f.,nLin,oFont08C)		//-- Tp. Tarefa
			ImprG(aSal[01,2],"C",,,0260,.f.,nLin,oFont08C)		//-- Data De 			
			ImprG(aSal[01,3],"C",,,0440,.f.,nLin,oFont08C)		//-- Data Ate 	
			ImprG(aSal[01,4],"C",,,0650,.f.,nLin,oFont08C)		//-- Tarefa 
			ImprG(aSal[01,5],"C",,,1270,.f.,nLin,oFont08C)		//-- Aulas Semana 			
			ImprG(aSal[01,6],"C",,,1520,.f.,nLin,oFont08C)		//-- Qtde. Tarefa 	
			ImprG(aSal[01,7],"C",,,1790,.f.,nLin,oFont08C)		//-- Valor Unitario 
			ImprG(aSal[01,8],"C",,,2110,.f.,nLin,oFont08C)		//-- Valor Total    
		ElseIf SRA->RA_CATFUNC $ "T" .and. cHist == "T"
			ImprG(aSal[01,2],"C",,,0060,.f.,nLin,oFont08C)		//-- Data De 			
			ImprG(aSal[01,3],"C",,,0230,.f.,nLin,oFont08C)		//-- Data Ate 	
			ImprG(aSal[01,4],"C",,,0390,.f.,nLin,oFont08C)		//-- Tarefa 
			ImprG(aSal[01,6],"C",,,1000,.f.,nLin,oFont08C)		//-- Qtde. Tarefa 	
			ImprG(aSal[01,7],"C",,,1260,.f.,nLin,oFont08C)		//-- Valor Unitario 
			ImprG(aSal[01,8],"C",,,1590,.f.,nLin,oFont08C)		//-- Valor Total    
		Else
			ImprG(aSal[01,1],"C",,,0060,.f.,nLin,oFont08)		//-- Cabecalho 
			ImprG(aSal[01,2],"C",,,0250,.f.,nLin,oFont08)		//-- Cabecalho 			
			ImprG(aSal[01,3],"C",,,0680,.f.,nLin,oFont08)		//-- Cabecalho 	
			ImprG(aSal[01,4],"C",,,0760,.f.,nLin,oFont08)		//-- Cabecalho 
			ImprG(aSal[01,5],"C",,,0830,.f.,nLin,oFont08)		//-- Cabecalho 			
			ImprG(aSal[01,6],"C",,,1250,.f.,nLin,oFont08)		//-- Cabecalho 	
			ImprG(aSal[01,7],"C",,,1450,.f.,nLin,oFont08)		//-- Cabecalho 
			If SR7->( Type("R7_DESCCAR") ) # "U"
				ImprG(aSal[01,8],"C",,,1840,.f.,nLin,oFont08)	// Detalhe campo ( cargo )
			EndIf
		EndIf
		// A Soma no nLin foi tirada de dentro do IF acima, pois estava imprimindo
		// a proxima informacao de alteracao salarial na linha do cabecalho
		nLin+=50 
	Endif

	If SRA->RA_CATFUNC $ "I#J" .and. cHist == "T" 
		ImprG(aSal[n,1],"C",,, 060,.f.,nLin,oFont08C)					// Detalhe campo ( Tp. Tarefa )
		ImprG(aSal[n,2],"C",,, 260,.f.,nLin,oFont08C)					// Detalhe campo ( Data de )
		ImprG(aSal[n,3],"C",,, 440,.f.,nLin,oFont08C)					// Detalhe campo ( Data Ate )
		ImprG(aSal[n,4],"C",,, 650,.f.,nLin,oFont08C)					// Detalhe campo ( Tarefa )
		ImprG(aSal[n,5],"C",,,1270,.f.,nLin,oFont08C)					// Detalhe campo ( Aulas Semana )
		ImprG(aSal[n,6],"C",,,If(n==1,1520,1520),.f.,nLin,oFont08C)	// Detalhe campo ( Qtde Tarefa )
		ImprG(aSal[n,7],"C",,,If(n==1,1790,1800),.f.,nLin,oFont08C)	// Detalhe campo ( Valor Unitario )
		ImprG(aSal[n,8],"C",,,If(n==1,2110,2080),.f.,nLin,oFont08C)	// Detalhe campo ( Valor Total )
	ElseIf SRA->RA_CATFUNC $ "T" .and. cHist == "T"
		ImprG(aSal[n,2],"C",,, 060,.f.,nLin,oFont08C)					// Detalhe campo ( Data de )
		ImprG(aSal[n,3],"C",,, 230,.f.,nLin,oFont08C)					// Detalhe campo ( Data Ate )
		ImprG(aSal[n,4],"C",,, 390,.f.,nLin,oFont08C)					// Detalhe campo ( Tarefa )
		ImprG(aSal[n,6],"C",,,If(n==1,1000,1000),.f.,nLin,oFont08C)	// Detalhe campo ( Qtde Tarefa )
		ImprG(aSal[n,7],"C",,,If(n==1,1260,1250),.f.,nLin,oFont08C)	// Detalhe campo ( Valor Unitario )
		ImprG(aSal[n,8],"C",,,If(n==1,1590,1570),.f.,nLin,oFont08C)	// Detalhe campo ( Valor Total )
	Else
		ImprG(aSal[n,1],"C",,, 060,.f.,nLin,oFont08)	// Detalhe campo ( Data )
		ImprG(aSal[n,2],"C",,, 250,.f.,nLin,oFont08)	// Detalhe campo ( Desc. Aumento )
		ImprG(aSal[n,3],"C",,, 680,.f.,nLin,oFont08)	// Detalhe campo ( Categoria )
		ImprG(aSal[n,4],"C",,, 760,.f.,nLin,oFont08)	// Detalhe campo ( Pagamento )
		ImprG(aSal[n,5],"C",,, 830,.f.,nLin,oFont08)	// Detalhe campo ( Verba )
		ImprG(aSal[n,6],"C",,,1250,.f.,nLin,oFont08)	// Detalhe campo ( Valor )
		ImprG(aSal[n,7],"C",,,1450,.f.,nLin,oFont08)	// Detalhe campo ( Funcao )
		If SR7->( Type("R7_DESCCAR") ) # "U"
			ImprG(aSal[n,8],"C",,,1840,.f.,nLin,oFont08)	// Detalhe campo ( cargo )
		EndIf
	EndIf
	nLin += 50 
Next N
ImprG("","C",,,,,nLinhas)              
Return  

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpSalN  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function fImpSalN(aSal,cHist)

Local N,M, nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")

//-- Box Detalhe         
If SRA->RA_CATFUNC $ "T" .and. cHist == "T"
	aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
	aAdd(aDetalhe,"|                                                                              |")
	aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
	aAdd(aDetalhe,"|         |         |              |            |               |              |")
	aAdd(aDetalhe,"|---------+---------+--------------+------------+---------------+--------------|")
				//  Data De   Data Ate  Tarefa          Qtde.Tarefa    Vl. Unitario       Vl Total
				//  99/99/99  99/99/99   999            9,999,999.99 9,999,999.9999  9,999,999.9999
				//  1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
				//         10        20        30        40        50        60        70        80        90        100

ElseIf SRA->RA_CATFUNC $ "I#J" .and. cHist == "T"
	aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
	aAdd(aDetalhe,"|                                                                              |")
	aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
	aAdd(aDetalhe,"|        |        |              |        |      |              |              |")
	aAdd(aDetalhe,"|--------+--------+--------------+--------+------+--------------+--------------|")
				//  Data De |Data Ate|Tarefa        |Aul/Sem.|Q.Tar.|  Vl. Unitario|     Vl Total
				//  99/99/99|99/99/99|999-5678901234| 999.99 |999.99|9,999,999.9999|9,999,999.9999
				//  1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
				//         10        20        30        40        50        60        70        80        90        100

Else
	aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
	aAdd(aDetalhe,"|                                                                              |")
	aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
	aAdd(aDetalhe,"|          |                    |     |     |                    |             |")
	aAdd(aDetalhe,"|          |                    |     |     |                    |             |")
	aAdd(aDetalhe,"|          |                    |     |     |                    |             |")
	aAdd(aDetalhe,"|----------+--------------------+-----+-----+--------------------+-------------|")
	             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
	             //          10        20        30        40        50        60        70       
	             // 99/99/9999                                                       99,999,999.99
EndIf

If SRA->RA_CATFUNC $ "I#J#T" .and. cHist == "T"
	nDet	:= (78 - Len(STR0015+STR0099)) / 2      // Alterações salariais - Tarefas                                         
	aDetalhe[2]	:= sTuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0015+STR0099)) , oEmtoAnsi(STR0015+STR0099) )   
Else	
	nDet	:= (78 - Len(STR0015)) / 2                                               
	aDetalhe[2]	:= sTuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0015)) , oEmtoAnsi(STR0015) )   
EndIf                                                                                 

If SRA->RA_CATFUNC $ "I#J" .and. cHist == "T"
	aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aSal[1,2]),aSal[1,2]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],11,len(aSal[1,3]),aSal[1,3]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],20,len(aSal[1,4]),aSal[1,4]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],35,len(aSal[1,5]),aSal[1,5])
	aDetalhe[4]	:= Stuff(aDetalhe[4],44,len(aSal[1,6]),aSal[1,6])
	aDetalhe[4]	:= Stuff(aDetalhe[4],52,len(aSal[1,7]),aSal[1,7])
	aDetalhe[4]	:= Stuff(aDetalhe[4],68,len(aSal[1,8]),aSal[1,8])
ElseIf SRA->RA_CATFUNC $ "T" .and. cHist == "T"
	aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aSal[1,2]),aSal[1,2]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],13,len(aSal[1,3]),aSal[1,3]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],23,len(aSal[1,4]),aSal[1,4]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],37,len(aSal[1,6]),aSal[1,6])
	aDetalhe[4]	:= Stuff(aDetalhe[4],50,len(aSal[1,7]),aSal[1,7])
	aDetalhe[4]	:= Stuff(aDetalhe[4],68,len(aSal[1,8]),aSal[1,8])
Else
	aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aSal[1,1]),aSal[1,1])  
	aDetalhe[4]	:= Stuff(aDetalhe[4],14,len(aSal[1,2]),aSal[1,2]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],35,len(aSal[1,3]),aSal[1,3]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],41,len(aSal[1,4]),aSal[1,4]) 
	aDetalhe[4]	:= Stuff(aDetalhe[4],47,len(aSal[1,5]),aSal[1,5])
	aDetalhe[4]	:= Stuff(aDetalhe[4],68,len(aSal[1,6]),aSal[1,6])
	aDetalhe[5]	:= Stuff(aDetalhe[5],13,len(aSal[1,7]),aSal[1,7])
	aDetalhe[6]	:= Stuff(aDetalhe[6],13,len(aSal[1,8]),aSal[1,8])
EndIf

If (LI +  Len(aDetalhe) + Len(aSal) + 04 ) >= 60
	Impr("","P")
Endif

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	
	                                    
For N:=2 To Len(aSal)

	If SRA->RA_CATFUNC $ "I#J#" .and. cHist == "T"
		Impr("|"+ aSal[n,2]					,"C",,,00,.F. )		//-- Data de 
		Impr("|"+ aSal[n,3]					,"C",,,09,.F. )		//-- Data Ate 
		Impr("|"+ substr(aSal[n,4],1,14)	,"C",,,18,.F. )		//-- Tarefa
		Impr("|"+ space(01)+aSal[n,5]		,"C",,,33,.F. )		//-- Aulas/Semana
		Impr("|"+ aSal[n,6]					,"C",,,42,.F. )		//-- Qtd. Tarefa
		Impr("|"+ aSal[n,7]					,"C",,,49,.F. )        //-- Valor unitario
		Impr("|"+ Substr(aSal[n,8],1,20)	,"C",,,64,.F. )		//-- Valor Total
		Impr("|"           					,"C",,,79,.T. )
	ElseIf SRA->RA_CATFUNC $ "T" .and. cHist == "T"
		Impr("|"+ aSal[n,2]					,"C",,,00,.F. )		//-- Data de 
		Impr("|"+ aSal[n,3]					,"C",,,10,.F. )		//-- Data Ate 
		Impr("|"+ substr(aSal[n,4],1,14)	,"C",,,20,.F. )		//-- Tarefa
		Impr("|"+ aSal[n,6]					,"C",,,35,.F. )		//-- Qtd. Tarefa
		Impr("|"+ aSal[n,7]					,"C",,,48,.F. )        //Valor unitario
		Impr("|"+ Substr(aSal[n,8],1,20)	,"C",,,64,.F. )
		Impr("|"           					,"C",,,79,.T. )
	Else
		Impr("|"+ aSal[n,1]					,"C",,,00,.F. )		//-- Data Alteracao
		Impr("|"+ aSal[n,2]					,"C",,,11,.F. )		//-- Descricao 
		Impr("|"+ aSal[n,3]					,"C",,,32,.F. )		//-- Categoria 
		Impr("|"+ aSal[n,4]					,"C",,,38,.F. )		//-- pgto
		Impr("|"+ aSal[n,5]					,"C",,,44,.F. )		//-- Verba
		Impr("|"+ aSal[n,6]					,"C",,,65,.F. )		//-- Valor 
		Impr("|"           					,"C",,,79,.T. )
		Impr("|"            				,"C",,,00,.F. ) 
		Impr("|"+ aSal[n,7]					,"C",,,11,.F. )
		Impr("|"            				,"C",,,32,.F. )
		Impr("|"            				,"C",,,38,.F. )
		Impr("|"            				,"C",,,44,.F. )
		Impr("|"            				,"C",,,65,.F. )
		Impr("|"            				,"C",,,79,.T. )
		Impr("|"            				,"C",,,00,.F. ) 
		Impr("|"+ Substr(aSal[n,8],1,20)	,"C",,,11,.F. )
		Impr("|"            				,"C",,,32,.F. )
		Impr("|"            				,"C",,,38,.F. )
		Impr("|"            				,"C",,,44,.F. )
		Impr("|"            				,"C",,,65,.F. )
		Impr("|"           					,"C",,,79,.T. )
    EndIf
Next n
Impr("","C") 
Impr(aDetalhe[1],"C")
Return  

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpAfasG ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpAfasG(aAfas)
Local nLinhas	:= 0
Local N 		:= 0 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aAfas,@nLinhas)
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fAfastBox(nLinhas) 
	
	For N:=1 To Len(aAfas)
 		If nLin + 100 >= nLinMax
 			
 			fFimPag(aAfas,N,@nLinhas) 
 			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fAfastBox(nLinhas)
			ImprG(aAfas[01,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 
			ImprG(aAfas[01,2],"C",,,0260,.f.,nLin,oFont08)			//-- Cabecalho 			
			ImprG(aAfas[01,3],"C",,,1250,.f.,nLin,oFont08)			//-- Cabecalho 	
			ImprG(aAfas[01,4],"C",,,1550,.f.,nLin,oFont08)			//-- Cabecalho 
			nLin+=50 
		Endif
		ImprG(aAfas[n,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo 
		ImprG(aAfas[n,2],"C",,, 260,.f.,nLin,oFont08)				// Detalhe campo
		ImprG(aAfas[n,3],"C",,,1250,.f.,nLin,oFont08)				// Detalhe campo
		ImprG(aAfas[n,4],"C",,,1550,.f.,nLin,oFont08)				// Detalhe campo
		nLin += 50
	Next N
	ImprG("","C",,,,,nLinhas)                      
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpAfasN ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpAfasN(aAfas)
Local N ,M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")

//-- Box Detalhe 
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|          |                                             |          |          |")
aAdd(aDetalhe,"|----------+---------------------------------------------+----------+----------|")
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70           
//            "|99/99/9999+---------------------------------------------+99/99/9999+99/99/9999|")
             
nDet	:= (78 - len(STR0018) ) /2
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0018)) , oEmtoAnsi(STR0018) )
aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aAfas[1,1]),aAfas[1,1]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],13,len(aAfas[1,2]),aAfas[1,2]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],59,len(aAfas[1,3]),aAfas[1,3]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],70,len(aAfas[1,4]),aAfas[1,4])

If (li + Len(aDetalhe) + Len(aAfas)+ 04  ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	
	
For N:=2 To Len(aAfas)
	Impr("|"+ aAfas[n,1],"C",,,00,.F. )
	IF len(aAfas[n,2]) > 45
		Impr("|"+ substr(aAfas[n,2],1,45),"C",,,11,.F. )
	Else 
		Impr("|"+ aAfas[n,2],"C",,,11,.F. )		
	Endif
	Impr("|"+ aAfas[n,3],"C",,,57,.F. )
	Impr("|"+ aAfas[n,4],"C",,,68,.F. )
	Impr("|","C",,,79 )
	IF len(aAfas[n,2]) > 45
		Impr("|"                           ,"C",,,00,.F. )	
		Impr("|"+ substr(aAfas[n,2],46,55),"C",,,11,.F. )
		Impr("|"                           ,"C",,,57,.F. )
		Impr("|"                           ,"C",,,68,.F. )
		Impr("|"                           ,"C",,,79 )
	Endif 	
Next n
Impr(aDetalhe[1],"C")
Return  

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpFeriaGºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpFeriaG(aFerias)
Local nLinhas	:= 0
Local N 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aFerias,@nLinhas)
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fFerBox(nLinhas) 
	For N:=1 To Len(aFerias)
		If nLin + 100 >= nLinMax

 			fFimPag(aFerias,N,@nLinhas) 
 			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fFerBox(nLinhas)
			ImprG(aFerias[01,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 
			ImprG(aFerias[01,2],"C",,,0410,.f.,nLin,oFont08)			//-- Cabecalho 			
			ImprG(aFerias[01,3],"C",,,0810,.f.,nLin,oFont08)			//-- Cabecalho 	
			ImprG(aFerias[01,4],"C",,,1160,.f.,nLin,oFont08)			//-- Cabecalho 
			ImprG(aFerias[01,5],"C",,,1510,.f.,nLin,oFont08)			//-- Cabecalho 			
			ImprG(aFerias[01,6],"C",,,1910,.f.,nLin,oFont08)			//-- Cabecalho 			
			nLin+=50 
		Endif
		ImprG(aFerias[n,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo
		ImprG(aFerias[n,2],"C",,, 410,.f.,nLin,oFont08)               // Detalhe campo
        ImprG(aFerias[n,3],"C",,, 810,.f.,nLin,oFont08)               // Detalhe campo
        ImprG(aFerias[n,4],"C",,,1160,.f.,nLin,oFont08)               // Detalhe campo
        ImprG(aFerias[n,5],"C",,,1510,.f.,nLin,oFont08)               // Detalhe campo
        ImprG(aFerias[n,6],"C",,,1910,.f.,nLin,oFont08)               // Detalhe campo
		nLin += 50 
	Next
	ImprG("","C",,,,,nLinhas)                  
Return


/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpFeriaNºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpFeriaN(aFerias)
Local N ,M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")

//-- Box Detalhe 
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|                       |                         |              |             |")
aAdd(aDetalhe,"|-----------------------+-------------------------+--------------+-------------|")
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70       
nDet	:= (78 - Len(STR0021)) / 2 
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0021)) , oEmtoAnsi(STR0021) )
aDetalhe[4]	:= Stuff(aDetalhe[4],03,len(aFerias[1,1]),aFerias[1,1]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],27,len(aFerias[1,2]),aFerias[1,2]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],53,len(aFerias[1,3]),aFerias[1,3]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],68,len(aFerias[1,4]),aFerias[1,4])

If (li + Len(aDetalhe) + Len(aFerias)+ 04 ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	
	
For N:=2 To Len(aFerias)
	Impr("|"+aFerias[n,1],"C",,,00,.F.)
	Impr("|"+aFerias[n,2],"C",,,24,.F.)
	Impr("|"+aFerias[n,3],"C",,,50,.F.)
	Impr("|"+aFerias[n,4],"C",,,65,.F.)
	Impr("|","C",,,79 )
Next N
Impr(aDetalhe[1],"C")
Return 


/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpCadG  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpCadG(aAltCad)
Local nLinhas	:= 0
Local N 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aAltCad,@nLinhas)
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fAltCadBox(nlinhas)
	
	For N:=1 To Len(aAltCad)
		If nLin + 100 >= nLinMax

			fFimPag(aAltCad,N,@nLinhas) 
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fAltCadBox(nLinhas)
			ImprG(aAltCad[01,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 
			ImprG(aAltCad[01,2],"C",,,0360,.f.,nLin,oFont08)			//-- Cabecalho 			
			ImprG(aAltCad[01,3],"C",,,0810,.f.,nLin,oFont08)			//-- Cabecalho 	
			nLin+=50 
		Endif	
		ImprG(aAltCad[n,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo  Data
		ImprG(aAltCad[n,2],"C",,, 360,.f.,nLin,oFont08)				// Detalhe campo  Campo Alt
		ImprG(aAltCad[n,3],"C",,, 810,.f.,nLin,oFont08)				// Detalhe campo  Descricao
		nLin += 50 
	Next N
	ImprG("","C",,,,,nLinhas)
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpCadN  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpCadN(aAltCad)
Local N , M, nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")
       
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|             |                   |                                            |")
aAdd(aDetalhe,"|-------------+-------------------+--------------------------------------------|")
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70       

nDet	:= (78 - Len(STR0024)) / 2  
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0024)) , oEmtoAnsi(STR0024) )
aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aAltCad[1,1]),aAltCad[1,1]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],17,len(aAltCad[1,2]),aAltCad[1,2]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],37,len(aAltCad[1,3]),aAltCad[1,3]) 


If ( Li + Len(aDetalhe) + Len(aAltCad) + 04 ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	

For n:= 2 to Len(aAltCad)
	Impr("|"+aAltCad[n,1],"C",,,00,.F.)
	Impr("|"+aAltCad[n,2],"C",,,14,.F.)
	Impr("|"+aAltCad[n,3],"C",,,34,.F.)
	Impr("|","C",,,79 )
Next n 

Impr(aDetalhe[1],"C")
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpDepG  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpDepG(aDep)
Local nLinhas	:= 0
Local N 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aDep,@nLinhas)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fDepBox(nLinhas)
	For N:=1 To Len(aDep)
	
		If nLin + 100 >= nLinMax

			fFimPag(aDep,N,@nLinhas)
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fDepBox(nLinhas)
			ImprG(aDep[01,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 
			ImprG(aDep[01,2],"C",,,0210,.f.,nLin,oFont08)			//-- Cabecalho 			
			ImprG(aDep[01,3],"C",,,0900,.f.,nLin,oFont08)			//-- Cabecalho 	
			ImprG(aDep[01,4],"C",,,0120,.f.,nLin,oFont08)			//-- Cabecalho 	
			ImprG(aDep[01,5],"C",,,1410,.f.,nLin,oFont08)			//-- Cabecalho 	
			ImprG(aDep[01,6],"C",,,1710,.f.,nLin,oFont08)			//-- Cabecalho 				
			ImprG(aDep[01,7],"C",,,1910,.f.,nLin,oFont08)			//-- Cabecalho 				
			nLin+=50 
		Endif	
	
		ImprG(aDep[n,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo Cod		    
		ImprG(aDep[n,2],"C",,, 210,.f.,nLin,oFont08)				// Detalhe campo Nome
		ImprG(aDep[n,3],"C",,, 900,.f.,nLin,oFont08)				// Detalhe campo Dt nasc
		ImprG(aDep[n,4],"C",,,1200,.f.,nLin,oFont08)				// Detalhe campo Sexo
		ImprG(aDep[n,5],"C",,,1410,.f.,nLin,oFont08)				// Detalhe campo Parentesco
		ImprG(aDep[n,6],"C",,,1710,.f.,nLin,oFont08)				// Detalhe campo Dep IR		
		ImprG(aDep[n,7],"C",,,1910,.f.,nLin,oFont08)				// Detalhe campo Dep S.Fam.
		nLin += 50 
	Next            
	ImprG("","C",,,,,nLinhas)
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpDepN  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpDepN(aDEp)
Local N , M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")
				
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|   |                              |          |    |         |      |          |")
aAdd(aDetalhe,"|---+------------------------------+----------+----+---------+------+----------|")
             //|99 |XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 99/99/9999| X       X       X        X    |
             //|Cod|Nome                           Dt.Nasc.   Sexo Parent  |Dp.IR.|Dp.S.Fam. |"  
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70       
nDet	:= (78 - Len(STR0026)) / 2 
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0026)) , oEmtoAnsi(STR0026) )
aDetalhe[4]	:= Stuff(aDetalhe[4],02,(len(Trim(aDep[1,1]))),aDep[1,1]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],06,len(aDep[1,2]),aDep[1,2]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],37,len(aDep[1,3]),aDep[1,3]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],48,len(aDep[1,4]),aDep[1,4]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],53,len(aDep[1,5]),aDep[1,5]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],63,len(aDep[1,6]),aDep[1,6])
aDetalhe[4]	:= Stuff(aDetalhe[4],70,len(aDep[1,7]),aDep[1,7]) 

If (Li + Len(aDetalhe) + Len(aDep)+ 04 ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	

For N:=2  to Len(aDep)
	Impr("|"+aDep[n,1],"C",,,00,.F.)		//--Codigo
	Impr("|"+aDep[n,2],"C",,,04,.F.)		//--Dependente
	Impr("|"+aDep[n,3],"C",,,35,.F.)		//--Dt.Nasc.
	Impr("|"+substr(aDep[n,4],1,4),"C",,,46,.F.)		//--Sexo
	Impr("|"+aDep[n,5],"C",,,51,.F.)	//--Parent
	Impr("|"+aDep[n,6],"C",,,61,.F.)	//--Dp.Ir.
	Impr("|"+aDep[n,7],"C",,,68,.F.)	//--Dp.S.Fam.
	Impr("|","C",,,79 )
Next N

Impr(aDetalhe[1],"C")
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpBenG  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpBenG(aBenef)
Local nLinhas	:= 0
Local N 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aBenef,@nLinhas)
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fBenefBox(nlinhas)
	
	For N:=1 To Len(aBenef)
		If nLin + 100 >= nLinMax      
		
			fFimPag(aBenef,N,@nLinhas) 
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fBenefBox(nLinhas)
			ImprG(aBenef[01,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 				
			ImprG(aBenef[01,2],"C",,,0210,.f.,nLin,oFont08)			//-- Cabecalho 				
			nLin+=50
		Endif	
		ImprG(aBenef[n,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo		    
		ImprG(aBenef[n,2],"C",,, 210,.f.,nLin,oFont08)				// Detalhe campo
		nLin += 50 
	Next            
	ImprG("","C",,,,,nLinhas)
Return              


/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpBenN  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpBenN(aBenef)
Local N , M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")
				
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|    |                                                                         |") 
aAdd(aDetalhe,"|----+-------------------------------------------------------------------------|")
             //|Cod |Beneficiario 
             //  99
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70       
nDet	:= (78 - Len(STR0060)) / 2 
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0060)) , oEmtoAnsi(STR0060) )
aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aBenef[1,1]),aBenef[1,1])
aDetalhe[4]	:= Stuff(aDetalhe[4],07,len(aBenef[1,2]),aBenef[1,2])

If (Li + Len(aDetalhe) + Len(aBenef) + 04 ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	

For N:=2  to Len(aBenef)
	Impr("|"+aBenef[n,1],"C",,,00,.F.)
	Impr("|"+aBenef[n,2],"C",,,05,.F.)
	Impr("|","C",,,79 )
Next N

Impr(aDetalhe[1],"C")
Return

       
/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpSindG ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpSindG(aConSin, cTituSind)

Local nLinhas	:= 0
Local nPos		:= 0 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aConSin,@nLinhas)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fContSindBox(nLinhas, cTituSind)

	For nPos:=1 To Len(aConSin)
		If nLin + 100 >= nLinMax      
		
			fFimPag(aConSin,nPos,@nLinhas)

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fContSindBox(nLinhas,cTituSind)	
			ImprG(aConSin[01,1]           ,"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 				
			ImprG(aConSin[01,2]           ,"C",,,0310,.f.,nLin,oFont08)			//-- Cabecalho 				
			ImprG(aConSin[01,3]           ,"C",,,0700,.f.,nLin,oFont08)			//-- Cabecalho 				
			ImprG(left(aConSin[nPos,4],50),"C",,,1140,.f.,nLin,oFont10)			//-- Detalhe campo
			nLin+=50                                                                   
		Endif	
		ImprG(aConSin[nPos,1],"C",,, 060,.f.,nLin,oFont08)				// Detalhe campo		    
		ImprG(aConSin[nPos,2],"C",,, 310,.f.,nLin,oFont08)				// Detalhe campo
		ImprG(aConSin[nPos,3],"C",,, 700,.f.,nLin,oFont08)				// Detalhe campo
		ImprG(left(aConSin[nPos,4],50),"C",,,1140,.f.,nLin,oFont10)	// Detalhe campo
		nLin += 50 
	Next nPos
	ImprG("","C",,,,,nLinhas)
Return
       
/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpSindN ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpSindN(aConSin, cTituSind)
Local N , M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")
				
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|           |       |               |                                          |")
aAdd(aDetalhe,"|-----------+-------+---------------+------------------------------------------|")
            //"|Data       | Mes   |          Valor| Sindicato                                |"
             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
             //         10        20        30        40        50        60        70       
nDet	:= (78 - Len(cTituSind)) / 2 
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(cTituSind)) , oEmtoAnsi(cTituSind) )
aDetalhe[4]	:= Stuff(aDetalhe[4],02,len(aConSin[1,1]),aConSin[1,1]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],14,len(aConSin[1,2]),aConSin[1,2]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],22,len(aConSin[1,3]),aConSin[1,3]) 
aDetalhe[4]	:= Stuff(aDetalhe[4],38,len(aConSin[1,4]),aConSin[1,4]) 
                                
If ( LI + Len(aDetalhe) + Len(aConSin)+ 04 ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	

For N:=2  to Len(aConSin)
	Impr("|"+aConSin[n,1],"C",,,00,.F.)
	Impr("|"+aConSin[n,2],"C",,,12,.F.)
	Impr("|"+aConSin[n,3],"C",,,20,.F.)
	Impr("|"+left(aConSin[n,4],40), "C",,,36,.F.)
	Impr("|","C",,,79 )	
Next N

Impr(aDetalhe[1],"C")
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpTraG  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Grafico                  º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼*/
Static Function  fImpTraG(aTransf)
Local nLinhas	:= 0
Local nTra
Local nY 

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Testa Quebra de Pagina                                       ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTestaQuebra(aTransf,@nLinhas)
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Box Detalhe                                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	fTranBox(nLinhas)
	
	/*
	ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Imprimindo Transferencias                                    ³ 
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	
	For nTra=1 To Len(aTransf)
 		
 		If nLin + 100 >= nLinMax
 		
			fFimPag(aTransf,NTra,@nLinhas) 

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Box Detalhe                                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			fTranBox(nLinhas)
			For nY = 1 to 2
				ImprG(aTransf[nY,1],"C",,,0060,.f.,nLin,oFont08)			//-- Cabecalho 
				ImprG(aTransf[nY,2],"C",,,0260,.f.,nLin,oFont08)			//-- Cabecalho 			
				ImprG(aTransf[nY,3],"C",,,1080,.f.,nLin,oFont08)			//-- Cabecalho 	
				nLin+=50 
			Next nY 
		Endif

		If !Empty(aTransf[nTra,1])
			ImprG(aTransf[nTra,1],"C",,,060,.f.,nLin,oFont08)				//Detalhe campo	
		Endif	
		ImprG(aTransf[nTra,2],"C",,, 260,.f.,nLin,oFont08)					//Detalhe campo
		ImprG(aTransf[nTra,3],"C",,,1800,.f.,nLin,oFont08)					//Detalhe campo			
		nLin += 50 
	Next nTra
	ImprG("","C",,,,,nLinhas)
Return

/*
ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»
ºPrograma  ³fImpTraN  ºAutor  ³Desenv - RH Natie   º Data ³  12/13/01   º
ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹
ºDesc.     ³ Impressao Linhas de detalhe  Modo Normal                   º
ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
*/
Static Function  fImpTraN(aTransf)
Local N , M , nDet
Local aDetalhe	:= {}

If li >= 60 
	Impr(" ","P")
Endif
Impr("","C")
				
aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
aAdd(aDetalhe,"|                                                                              |")
aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
aAdd(aDetalhe,"|           |                                                                  |")
aAdd(aDetalhe,"|           |                                                                  |")
aAdd(aDetalhe,"|-----------+------------------------------------------------------------------|")
            //"|           | Empresa de Origem                                                | "
            //"|Data       | Empresa de Destino                                               | "
            // 12345678901234567890123456789012345678901234567890123456789012345678901234567890
            //          10        20        30        40        50        60        70       
nDet	:= (78 - Len(STR0041)) / 2 
aDetalhe[2]	:= stuff(aDetalhe[2],nDet,len(oemtoAnsi(STR0041)) , oEmtoAnsi(STR0041) )
aDetalhe[4]	:= Stuff(aDetalhe[4],14,len(aTransf[1,2]),aTransf[1,2])
aDetalhe[4]	:= Stuff(aDetalhe[4],65,len(aTransf[1,3]),aTransf[1,3])
aDetalhe[5]	:= Stuff(aDetalhe[5],02,len(aTransf[2,1]),aTransf[2,1])
aDetalhe[5]	:= Stuff(aDetalhe[5],14,len(aTransf[2,2]),aTransf[2,2])
aDetalhe[5]	:= Stuff(aDetalhe[5],65,len(aTransf[2,3]),aTransf[2,3])

If ( Li + Len(aDetalhe) + Len(aTransf)+ 04  ) >= 60
	Impr("","P")
Endif	

For m:= 1 to Len(aDetalhe)
	Impr(aDetalhe[m],"C")
Next m	

For N:=3  to Len(aTransf)
	Impr("|","C",,,00,.F.)
	If !empty(aTransf[n,3])
		Impr("|"+aTransf[n,3],"C",,,12,.F.)
		Impr("|","C",,,79 )	
	Endif
	If !empty(aTransf[n,1] )
		Impr("|"+aTransf[n,1],"C",,,00,.F.)
	endif	
	Impr("|"+aTransf[n,2],"C",,,12,.F.)
	Impr("|","C",,,79 )	
Next N
Impr(aDetalhe[1],"C")
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³CabecGraf ºAutor  ³Microsiga - Natie   º Data ³  12/18/01   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static FUNCTION cabecGraf(cTitulo,cCabec1,cCabec2,cNomPrg,nTamanho,aCustomText,lPerg)

Local nLargura
Local nLin	:=0

Default aCustomText := Nil // Parâmetro que se passado suprime o texto padrao desta função por outro customizado

nlargura:= IF(nTamanho=="P",2250,IF(nTamanho=="G",2300,2500))
cTitulo :=Iif(TYPE("NewHead")!="U",NewHead,cTitulo)
cNomPrg := Alltrim(cNomPrg)

	
//Box Itens
oPrint:Box( 330, 30, nLinMax, 2350 )
                  
nLin 	:= 410
nColuna	:= 100

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Imprime box com foto funcionario                             ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
If lFirst
   	//-- Verifica foto do funcionario
	fFoto()
	
	nColuna	:= 600
	If  Len(aCustomText) >0
		/*
		ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		³ Imprime texto de outro cabecalho passado no array            ³
		ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
		//-- Desenha Cabecalho 
		oPrint:Line(nlin,nColuna-10  ,nlin+60, nColuna-10)				//1a linha
		oPrint:Line(nlin,nColuna+1180,nlin+60, nColuna+1180) 			//1a linha
		oPrint:Line(nlin+60,nColuna-10  ,nlin+60, nColuna+1180) 		//Horizontal
		oPrint:say(nLin,ncoluna,aCustomText[1],oFont10) 				//Empresa	
		
		oPrint:Line(nlin,nColuna+1190,nlin+60, nColuna+1190) 			//1a linha
		oPrint:Line(nlin,nColuna+1700,nlin+60, nColuna+1700) 			//1a linha
		oPrint:Line(nlin+60,nColuna+1190,nlin+60, nColuna+1700) 		//Horizontal
		oTamFont := If( Len(aCustomText[2]) > 22, oFont08c, oFont10 ) 	//Reduz a fonte p/ nao ultrapassar o limite
		oPrint:say(nLin,ncoluna+1200,aCustomText[2],oTamFont) 			//Filial
		nLin +=90	                 
		
		oPrint:Line(nlin,nColuna-10  ,nlin+60, nColuna-10)				//2a Linha
		oPrint:Line(nlin,nColuna+1700,nLin+60, nColuna+1700)			//2a Linha
		oPrint:Line(nlin+60,nColuna-10  ,nlin+60, nColuna+1700) 		//Horizontal 
		oTamFont := If( Len(aCustomText[3]) > 75, oFont08c, oFont10 )	//Reduz a fonte p/ nao ultrapassar o limite
		oPrint:say(nLin,ncoluna,aCustomText[3],oTamFont)				//Endereco
		nLin +=90			

		oPrint:Line(nlin,nColuna-10  ,nlin+60 , nColuna-10) 			//3a Linha
		oPrint:Line(nlin,nColuna+1180,nlin+60 , nColuna+1180)			//3a Linha
		oPrint:Line(nlin+60,nColuna-10  ,nlin+60 , nColuna+1180)		//Horizontal
		oPrint:say(nLin,ncoluna,aCustomText[4],oFont10) 				//Municipio
		
		oPrint:Line(nlin,nColuna+1190,nlin+60, nColuna+1190) 			//3a Linha
		oPrint:Line(nlin,nColuna+1700,nlin+60, nColuna+1700) 			//3a Linha
		oPrint:Line(nlin+60,nColuna+1190,nlin+60, nColuna+1700) 		//Horizontal
		oPrint:say(nLin,ncoluna+1200,aCustomText[5],oFont10) 			//Cep
		nLin +=90
	
		oPrint:Line(nlin,nColuna-10 ,nlin+60, nColuna-10)				//4a Linha
		oPrint:Line(nlin,nColuna+600,nLin+60, nColuna+600)				//4a Linha
		oPrint:Line(nlin+60,nColuna-10 ,nlin+60, nColuna+600)			//Horizontal
		oPrint:say(nLin,ncoluna,aCustomText[6],oFont10) 				//CGC
		
		oPrint:Line(nlin,nColuna+620 ,nlin+60, nColuna+620) 			//4a Linha
		oPrint:Line(nlin,nColuna+1180,nlin+60, nColuna+1180) 			//4a Linha
		oPrint:Line(nlin+60,nColuna+620 ,nlin+60, nColuna+1180) 		//Horizontal       
		oPrint:say(nLin,ncoluna+630,aCustomText[7],oFont10) 			//CNAE
			
		oPrint:Line(nlin,nColuna+1190,nlin+60, nColuna+1190) 			//4a Linha
		oPrint:Line(nlin,nColuna+1700,nlin+60, nColuna+1700) 			//4a Linha
		oPrint:Line(nlin+60,nColuna+1190,nlin+60, nColuna+1700) 		//Cod.Municipio
		oPrint:say(nLin,ncoluna+1200,aCustomText[8],oFont10)
		
	Endif
	lfirst	:= .F. 
	nLin 	+= 100
Endif

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Imprime Funcionario                                          ³ 
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/ 

oPrint:Line(nLin+15 ,nColuna-10  ,nLin+090 , nColuna-10  )		//1a vertical 
oPrint:Line(nLin+15 ,nColuna+300 ,nLin+090 , nColuna+300 )		//2a vertical 
oPrint:Line(nLin+90 ,nColuna-10  ,nlin+090 , nColuna+300 )		//horizontal 
oPrint:say(nLin     ,nColuna,"No Ficha"   ,oFont08n ) 			//Ficha 
oPrint:say(nLin+40  ,nColuna,SRA->RA_FICHA,oFont12n) 

oPrint:Line(nLin+15 ,nColuna+310 ,nLin+090 , nColuna+310)		//1a vertical
oPrint:Line(nLin+15 ,nColuna+700 ,nLin+090 , nColuna+700)		//2a vertical 
oPrint:Line(nLin+90 ,nColuna+310 ,nlin+090 , nColuna+700)		//horizontal
oPrint:say(nLin     ,nColuna+320,STR0004,oFont08n) 
oPrint:say(nLin+40  ,nColuna+320,SRA->RA_MAT,oFont12n)

oPrint:Line(nLin+15 ,nColuna+710  ,nLin+090  , nColuna+710)	//1a vertical
oPrint:Line(nLin+15 ,nColMax-10   ,nLin+090  , nColMax-10 )	//2a vertical 
oPrint:Line(nLin+090,nColuna+710  ,nlin+090  , nColMax-10 )	//horizontal
oPrint:say(nLin     , nColuna+720 ,STR0006   , oFont08n)
oPrint:Say(nLin+40  , nColuna+720 ,SRA->RA_NOME,oFont12n)

nLin 	+= 150
nColuna := 50

If LEN(Trim(cCabec1)) != 0
	ImprG(cCabec1,"C",,,nColuna,.T. ,nLin,oFont12)
	If LEN(Trim(cCabec2)) != 0
		ImprG(cCabec2,"C",,,nColuna,.T. ,nLin,oFont12)
	EndIf 
	oPrint:Line(nLin,nColuna-20,nLin,nColMax)
	nLin 	+=40
Else	
	oPrint:Line(nLin,nColuna-20,nLin,nColMax)
EndIf

m_pag++

nLin+= 40

Return nLin

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³GPER460   ºAutor  ³Microsiga           º Data ³  02/19/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Imprime Rodape Grafico                                      º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
USER Function PTfRodaPe(wcbcont,wcbtxt,roda_tam)
Local cFileLogo	:= ""

//-- Carrega Logotipo para impressao 
fCarLogo(@cFileLogo) 

oPrint:Line(nLinMax+020,050,nLinMax+020,nColMax)			      	// Linha horizontal 

IF File(cFilelogo)
	oPrint:SayBitmap(nLinMax + 040,50, cFileLogo,300,080) 			// Tem que estar abaixo do RootPath
Endif	

If nTipFicha == 1
	oPrint:say(nLinMax +060,2000, STR0123+Time(),oFont08)
	oPrint:Line(nLinMax+100,050,nLinMax+100,nColMax)			      	// Linha horizontal 
	oPrint:EndPage()
Else
	oPrint:say(nLinMax + 030,500, STR0110, oFont08)
	oPrint:say(nLinMax + 060,500, STR0111, oFont08)
	oPrint:say(nLinMax + 090,500, STR0112, oFont08)
	oPrint:say(nLinMax + 090,2000, "-  "+STR0123+Time(),oFont08)

	oPrint:Line(nLinMax+130,050,nLinMax+130,nColMax)			      	// Linha horizontal 
	oPrint:EndPage()
EndIf	

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³ImprG     ºAutor  ³Microsiga           º Data ³  18/02/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function ImprG( cDetalhe , cFimFolha , nReg , cRoda , nColun , lSalta , nLinha,oFont)

Local aCabec := {}
Local cDetCab:= ""
Local cWCabec:= ""
Local nCb	 := 0
Local nLargura := IF(nTamanho=="P",2250,IF(nTamanho=="G",2300,2500))

Static lPerg 

m_pag		:= ContFl
cFimFolha	:= IF( cFimFolha		== NIL							  		, ""		, cFimFolha	)
cDetalhe	:= IF( cDetalhe			== NIL							  		, ""		, cDetalhe	)
wCabec0 	:= IF( Type("wCabec0")	== "U"							  		, 0			, wCabec0	)
wCabec1 	:= IF( Type("wCabec1")	== "U"							  		, ""		, wCabec1	)
wCabec2 	:= IF( Type("wCabec2")	== "U"							  		, ""		, wCabec2	)
nReg		:= IF( nReg				== NIL							  		, 0.00		, nReg		)
wnRel		:= IF( Type("wnRel")	== "U" .and. Type("nomeprog") != "U"	, nomeprog	, wnRel		)
nColun 		:= IF( nColun			== NIL							  		, 0			, nColun	)
nLinha		:= IF( nLinha			== NIL							  		, 0			, nLinha	)
lSalta		:= IF( lSalta 			== NIL							  		, .T. 		, lSalta	)


IF Upper(cFimFolha) $ "FP" .or. nLinha >= nLinMax
	IF nLinha != 0.00
		IF Upper(cFimFolha) $ "F" .or. cRoda != NIL
			IF nReg == 0.00 .or. cRoda == NIL
				U_PTfRodaPe( 0.00 , ""    , nTamanho)
			Else
				U_PTfRodaPe( nReg , cRoda , nTamanho)
			EndIF
		EndIF
		nLinha := 0.00
	EndIF
	IF Upper(cFimFolha) $ "FP"
		Return( NIL )
	EndIF
EndIF

IF nLinha == 0.00
	oPrint:StartPage() 			//Inicia uma nova pagina
	SendCab1(nLargura,nLinha, nColun)
	For nCb := 1 to wCabec0-1
		IF Type((cWCabec := "wCabec"+Alltrim(Str(nCb)))) != "U"
			cDetCab := &(cWCabec)
			aAdd(aCabec,cDetCab)
		EndIF
	Next nCb
	nlinha:=  CabecGraf( Titulo , "" , "" , wnrel , nTamanho ,aCabec, lPerg )
	ContFl++
EndIF                         

//-- Imprime linha de detalhe 
oPrint:say(nLinha,nColun,cDetalhe,oFont)

IF lSalta
	nLinha += 40
Endif

nLin	:= nLinha
nColuna	:= nColun

Return nlin


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³SendCab1  ºAutor  ³Microsiga           º Data ³  18/02/01   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function SendCab1(nSpace,nLinha, nColun)

Local cDetCab 	:= ""
Local nEspaco 	:= 0
Local cFileLogo	:= ""

//-- Carrega Logotipo para impressao 
  fCarLogo(@cFileLogo) 

// Nome da Empresa / Pagina  / Logotipo
oPrint:Line(020,nColun-20,020,nColMax)
If File(cFilelogo)
	oPrint:SayBitmap(045,50, cFileLogo,400,090) // Tem que estar abaixo do RootPath
Endif	
cDetCab 	:=  STR0120 +" " + TRANSFORM(m_pag,'999999')
oPrint:say(100, 1950  ,cDetCab,oFont10)

// Versão     
cDetCab := "SIGA /"+wnrel+"/v."+cVersao+"  "
oPrint:say(150,nColun -10 ,cDetCab,oFont10)

//-- Titulo 
cDetCab := Trim(Titulo)
nEspaco	:= (nColMax - Len(AllTrim(Titulo)) *100 / 6 ) / 2
oPrint:say(150, nEspaco , cDetCab, oFont12n)

cDetCab :=  STR0122 +" "+ DTOC(dDataBase)
oPrint:say(150,1950,cDetCab,oFont10)


// Hora da emissão / Data Emissao
cDetCab := STR0121+" "+time()
oPrint:say(200,nColun-10,cDetCab,oFont10)

cDetCab := STR0124+" "+DToC(MsDate())
oPrint:say(200,1950,cDetCab,oFont10)

oPrint:Line(280,nColun-20,280,nColMax)

Return  

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fcarLogo  ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

Static Function fCarLogo(cLogo)
Local  cStartPath:= GetSrvProfString("Startpath","")

cLogo	:= cStartPath + "LGRL"+FwCodEmp("SM0")+FWGETCODFILIAL+".BMP" // Empresa+Filial
//-- Logotipo da Empresa
If !File( cLogo )
	cLogo := cStartPath + "LGRL"+FwCodEmp("SM0")+".BMP" // Empresa
Endif

Return cLogo

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fFoto     ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fFoto()

Local aArea		:= GetArea()
Local cAlias	:= "PROTHEUS_REPOSIT"
Local cBmpPict	:= ""
Local cPath		:= GetSrvProfString("Startpath","")
Local lFile		
Local oDlg8
Local oBmp

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Carrega a Foto do Funcionario								   ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
cBmpPict := Upper( AllTrim( SRA->RA_BITMAP)) 
cPathPict 	:= ( cPath + cBmpPict ) 

/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Para impressao da foto eh necessario abrir um dialogo para   ³
³ extracao da foto do repositorio.No entanto na impressao,nao  |
³ ha a necessidade de visualiza-lo( o dialogo).Por esta razao  ³
³ ele sera montado nestas coordenadas fora da Tela             ³
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
DEFINE MSDIALOG oDlg8   FROM -1000000,-4000000 TO -10000000,-8000000  PIXEL 
@ -10000000, -1000000000000 REPOSITORY oBmp SIZE -6000000000, -7000000000 OF oDlg8  

If _lRepDb
	dbSelectArea(cAlias)
	(cAlias)->( dbSeek(cBmpPict) )
EndIf

// Verifica se a imagem existe no repositorio
If oBMP:ExistBMP(cBmpPict)
	If !_lRepDb
		oBmp:LoadBmp(cBmpPict)
	EndIf
	
	//-- Box com  Foto 
	oPrint:Box( 380,60,900, 460 )
	IF !Empty( cBmpPict := Upper( AllTrim( SRA->RA_BITMAP ) ) )
		lFile:=oBmp:Extract(cBmpPict, cPathPict)
		If lFile 
			If File(cPathPict+".BMP") 
				oPrint:SayBitmap(400,75,cPathPict + ".BMP",370,480)
				aAdd(aFotos,cPathPict + ".BMP")
			ElseIf File(cPathPict+".JPG")
				oPrint:SayBitmap(400,75,cPathPict + ".JPG",370,480)
				aAdd(aFotos,cPathPict + ".JPG")
			EndIf
		EndIf	
	EndIf	
EndIf
ACTIVATE MSDIALOG oDlg8 ON INIT (oBmp:lStretch := .T., oDlg8:End())

RestArea(aArea)

Return 
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fTranBox  ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box -Transferencias                                         º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fTranBox(nLinhas)
Local ncol 	:= int( ( nColBox - ( Len(STR0041) * 100 / 7) )) /2 

oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  ) 	// linha vertical ( box )
oPrint:Line(nLin + 050 , 050,nLin + 050 ,nColBox +10)
oPrint:Line(nLin + 150 , 050,nLin + 150 ,nColBox +10)
oPrint:Line(nLin + 50  , 250,nLinhas , 250)			// linha vertical
oPrint:Line(nLin + 50  , 1790,nLinhas ,1790)		// linha vertical
oPrint:say(nLin, nCol,STR0041,oFont10n )   			//-- Transferencias 
nLin += 50

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fSalBox   ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box-Alteracao Salarial                                      º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fSalBox(nLinhas,cHist)

Local nCol  := int( ( nColBox - ( Len(STR0015) * 100 / 7) )) /2
Local nColFim := 	If( SR7->( Type("R7_DESCCAR") ) # "U",130,50)

If SRA->RA_CATFUNC == "T" .and. cHist == "T"
	oPrint:box(nLin, nColuna ,nlinhas, 2000 ) 
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,2000)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,2000)	
Else 
	oPrint:box(nLin, nColuna ,nlinhas, nColBox + nColFim ) 
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +nColFim)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +nColFim)	
EndIf

If SRA->RA_CATFUNC $ "I#J" .and. cHist == "T"
	oPrint:Line(nLin + 50  , 230,nLinhas , 230) // Data de   
	oPrint:Line(nLin + 50  , 420,nLinhas , 420) // Data ate     
	oPrint:Line(nLin + 50  , 610,nLinhas , 610) // Tarefa      
	oPrint:Line(nLin + 50  ,1260,nLinhas ,1260) // Aulas/semana    
	oPrint:Line(nLin + 50  ,1510,nLinhas ,1510) // qtd. Tarefa 
	oPrint:Line(nLin + 50  ,1740,nLinhas ,1740)	 // Valor unitario
	oPrint:Line(nLin + 50  ,2040,nLinhas ,2040)		//Valor Total
ElseIf SRA->RA_CATFUNC $ "T" .and. cHist == "T"
	oPrint:Line(nLin + 50  , 220,nLinhas , 220) // Data ate     
	oPrint:Line(nLin + 50  , 380,nLinhas , 380) // Tarefa      
	oPrint:Line(nLin + 50  ,0980,nLinhas ,0980) // qtd. Tarefa 
	oPrint:Line(nLin + 50  ,1210,nLinhas ,1210) // Valor unitario
	oPrint:Line(nLin + 50  ,1530,nLinhas ,1530)	 // Valor Total
Else
	oPrint:Line(nLin + 50  , 240,nLinhas , 240) // Desc aumento
	oPrint:Line(nLin + 50  , 670,nLinhas , 670) //750 Categoria
	oPrint:Line(nLin + 50  , 750,nLinhas , 750) //850 Pagamento
	oPrint:Line(nLin + 50  , 820,nLinhas , 820) //1000 Verba 
	oPrint:Line(nLin + 50  ,1210,nLinhas ,1210) //1400 Valor
	oPrint:Line(nLin + 50  ,1440,nLinhas ,1440)	 //1695 Funcao
	If SR7->( Type("R7_DESCCAR") ) # "U"
		oPrint:Line(nLin + 50  ,1780,nLinhas ,1780)	 //1695 Cargo
	EndIf
EndIf	

If SRA->RA_CATFUNC $ "I#J#T" .and. cHist == "T"         
	nCol  := int( ( nColBox - ( Len(STR0015+STR0099) * 100 / 7) )) /2
	oPrint:say(nLin, nCol,STR0015+STR0099,oFont10n)
Else
	oPrint:say(nLin, nCol,STR0015,oFont10n)
EndIf	

nLin += 50

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fAfastBox ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Box- Afastamentos                                          º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fAfastBox(nLinhas)

Local nCol	:= int( ( nColBox - ( Len(STR0018) * 100 / 7) )) /2

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  ) 		
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)	
	oPrint:Line(nLin + 50  , 250,nLinhas , 250)
	oPrint:Line(nLin + 50  ,1240,nLinhas ,1240)
	oPrint:Line(nLin + 50  ,1540,nLinhas ,1540)
	oPrint:say(nLin, nCol,STR0018,oFont10n)
	nLin += 50
	
Return 
                  
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fFerBox   ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box - Ferias                                                º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static function fFerBox(nLinhas)
Local nCol	:= int( ( nColBox - ( Len(STR0021) * 100 / 7) )) /2

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  )
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)
    oPrint:Line(nLin + 50  , 400,nLinhas , 400)
    oPrint:Line(nLin + 50  , 800,nLinhas , 800)
    oPrint:Line(nLin + 50  ,1150,nLinhas ,1150)
    oPrint:Line(nLin + 50  ,1500,nLinhas ,1500)
    oPrint:Line(nLin + 50  ,1900,nLinhas ,1900)
	oPrint:say(nLin, nCol,STR0021,oFont10n )
	nLin += 50

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fAltCadBoxºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box-Alteracao Cadastrais                                    º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fAltCadBox(nLinhas)
Local nCol	:= int( ( nColBox - ( Len(STR0024) * 100 / 7) )) /2

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10 ) 	
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)
	oPrint:Line(nLin + 50  , 350,nLinhas , 350)
	oPrint:Line(nLin + 50  , 800,nLinhas , 800)
	oPrint:say(nLin, nCol,STR0024,oFont10n )
	nLin += 50
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fcarLogo  ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box Dependentes                                             º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fDepBox(nLinhas)
Local nCol	:= Int( ( nColBox - ( Len(STR0026) * 100 / 7) )) /2 

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  ) 
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)	
	oPrint:Line(nLin + 50  , 200,nLinhas , 200) 
	oPrint:Line(nLin + 50  , 890,nLinhas , 890) 
	oPrint:Line(nLin + 50  ,1190,nLinhas ,1190) 
	oPrint:Line(nLin + 50  ,1400,nLinhas ,1400)
	oPrint:Line(nLin + 50  ,1700,nLinhas ,1700)
	oPrint:Line(nLin + 50  ,1900,nLinhas ,1900)	
	oPrint:say(nLin, nCol,STR0026,oFont10n )  
	nLin += 50 

Return 
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fBenefBox ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box-Dependentes                                             º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

Static Function fBenefBox(nLinhas)
Local nCol	:= int( ( nColBox - ( Len(STR0060) * 100 / 7) )) /2

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  ) 		
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)	
	oPrint:Line(nLin + 50  , 200,nLinhas , 200)
	oPrint:say(nLin, nCol,STR0060,oFont10n )
	nLin += 50

Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fContSind ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box-Contribuiceos sindicais                                 º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fContSindBox(nlinhas, cTituSind)
Local nCol	:= int( ( nColBox - ( Len(cTituSind) * 100 / 7) )) /2

	oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  ) 		
	oPrint:Line(nLin + 50  , 050,nLin + 50  ,nColBox +10)	
	oPrint:Line(nLin + 100 , 050,nLin + 100 ,nColBox +10)	
	oPrint:Line(nLin + 50  , 300,nLinhas , 300)
	oPrint:Line(nLin + 50  , 690,nLinhas , 690)
	oPrint:Line(nLin + 50  ,1090,nLinhas ,1090)
	oPrint:say(nLin, nCol,cTituSind,oFont10n )
	nLin += 50
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fAssinatBox ºAutor  ³RH - Natie          º Data ³  12/09/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Box-Assinatura Empregado e responsavel pela Empresa           º±±
±±º          ³                                                              º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ MP8                                                          º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

Static Function fAssinaBox()
Local aArea		:= GetArea()
Local nLinhas 	:= 0 
Local nCol		:= int( ( nColBox - ( Len(STR0082) * 100 / 7) )) /2		// Assinaturas 
Local M 		:= 0 
Local aDetalhe 	:= {}

If nGrafica ==1 

	//-- Verifica quebra de pagina 
	If (nLin + 450) >= nLinMax 
		nLin  := 0
		oPrint:EndPage() 		// Finaliza a pagina
		nColuna := 50
		ImprG(" ","C",,,nColuna,,nLin,oFont10)
	Endif  
	
	If nTipFicha == 1
		nLinhas 	:= nLin + 450 
	
		nColuna		:= 050 
		
		oPrint:box(nLin, nColuna ,nlinhas, nColBox + 10  )
		oPrint:Line(nLin + 50  , 050 ,nLin + 50  ,nColBox +10)			//-- linha horizontal 
		oPrint:say(nLin        , nCol,STR0082,oFont10n )				//-- Assinaturas 
		oPrint:Line(nLin + 50  , 400 ,nLinhas    , 400)					//-- Vertical apos Polegar 
		oPrint:Line(nLin + 50  ,1300 ,nLinhas    ,1300)					//-- Vertical apos Assin.Func. 
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³                                                              ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ                
		oPrint:say(nLin+50    , nColuna+10, oemtoAnsi(STR0085),oFont08n )				//-- Polegar Direito 
		oPrint:say(nLIn+50    , 0410      , oEmToAnsi(STR0083),oFont08n)				//-- Assinat.Funciona 
		oPrint:say(nLIn+50    , 1310      , oEmToAnsi(STR0084),oFont08n)				//-- Assinat.Responsavel 
		oPrint:Line(nLin + 370 , 0420 ,nLin +370  ,1300)
		oPrint:Line(nLin + 370 , 1320 ,nLin +370 , 2200)
		//-- Assinatura do Funcionario 
		oPrint:say( nLin+380  , 0410   ,SRA->RA_NOME  ,oFont10n) 
		//-- Responsavel Legal 
		oPrint:say( nLin+380  , 1320   ,cResponsavel  ,oFont10n) 
		nLin +=50 
    
	EndIf
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³Finaliza impressao Grafica                                    ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ                
		ImprG(" " ,"F",0,,0,,nLin)	
		ContFl	:= 1						//-- Inicia nova numeracao da ficha  p/cada funcionario 
		oPrint:EndPage()
Else 
	If li  + 14 >= 60 
		Impr(" ","P")
	Endif
	Impr("","C")
					
	aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
	aAdd(aDetalhe,"|                                                                              |")
	aAdd(aDetalhe,"|------------------------------------------------------------------------------|")
	aAdd(aDetalhe,"|          |                                  |                                |")
	aAdd(aDetalhe,"|----------+----------------------------------+--------------------------------|")
	aAdd(aDetalhe,"|          |                                  |                                |")
	aAdd(aDetalhe,"|          |                                  |                                |")
	aAdd(aDetalhe,"|          |                                  |                                |")	
	aAdd(aDetalhe,"|          |                                  |                                |")	
	aAdd(aDetalhe,"|          | -------------------------------- | ------------------------------ |")
	aAdd(aDetalhe,"|          |                                  |                                |")
	aAdd(aDetalhe," ------------------------------------------------------------------------------ ")
	             //|Polegar   | Assinatura Funcionario             Responsavel Legal              |"  
	             //12345678901234567890123456789012345678901234567890123456789012345678901234567890
	             //         10        20        30        40        50        60        70       
	nDet			:= (78 - Len(STR0082)) / 2 
	aDetalhe[02]	:= stuff(aDetalhe[02],nDet,len(oemtoAnsi(STR0082)) ,oEmtoAnsi(STR0082) )
	aDetalhe[04]	:= Stuff(aDetalhe[04],02,len(oemtoAnsi(STR0085))   ,oemtoAnsi(STR0085) ) 
	aDetalhe[04]	:= Stuff(aDetalhe[04],13,len(oemtoAnsi(STR0083))   ,oemtoAnsi(STR0083) ) 
	aDetalhe[04]	:= Stuff(aDetalhe[04],49,len(oemtoAnsi(STR0084))   ,oemtoAnsi(STR0084) ) 
	aDetalhe[11]	:= Stuff(aDetalhe[11],13,len(SRA->RA_NOME )        ,SRA->RA_NOME  ) 
	aDetalhe[11]	:= Stuff(aDetalhe[11],49,len(cResponsavel)         ,left(cResponsavel,30)   ) 
	
	For m:= 1 to Len(aDetalhe)
		Impr(aDetalhe[m],"C")
	Next m	
		
Endif

RestArea( aArea)
Return 


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fTestaQuebºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Efetua Quebra de Pagina qdo Box de detalhe nao couber      º±±
±±º          ³ na folha atual                                             º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fTestaQuebra(aArray, nLinhas) 

If nLin >= nLinMax 
	oPrint:EndPage() 		// Finaliza a pagina
	ImprG(" " ,"P",,,nColuna,,0,)
Endif
ImprG(" " ,"C",,,nColuna,,nLin)

nLinhas	:= Int(nLin    + ( (Len(aArray)+1)   * 50 ) ) +50 
nColuna	:= 050 
/*
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³ Se Array nao couber em  uma pagina, efetua a quebra          |
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
If  nLinhas >= nLinMax
	oPrint:EndPage() 		// Finaliza a pagina
	ImprG(" ","C",,,nColuna,,0,oFont10)
	nLinhas	:= Int(nLin    + (( Len(aArray)+1)   * 50 ) ) + 50
	If nLinhas >= nLinMax
		nLinhas:= nLinMax-50
	Endif
Endif	
Return 

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fFimPag   ºAutor  ³RH - Natie          º Data ³  02/18/02   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Quebra da  pagina quando box de detalhe  for maior que a    º±±
±±º          ³pagina                                                      º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function fFimPag(aArray,nX,nLinhas)

oPrint:EndPage() 											// Finaliza a pagina

ImprG(" " ,"C", ,,050,,0,) 
nLinhas	:= Int(nLin    + ( (  (Len(aArray)+1) - NX ) * 50 ) ) + 150
If nLinhas >= nLinMax
	nLinhas:= nLinMax-50
Endif 
Return
			
Static Function fDescSexo(cCod)
Return(If(cCod =="F", STR0065, STR0064 ))	//"Feminino"###"Masculino"
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³GPER460   ºAutor  ³Microsiga           º Data ³  09/12/05   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

Static Function fImpPeriodo() 
Local aArea		:= GetArea()

nColuna	:= 050

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Periodo de Impressao                                         ³ 
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

If nGrafica ==1 
	If (nLin + 200) >= nLinMax 
		nLin  := 0
		oPrint:EndPage() 		// Finaliza a pagina
		ImprG(" ","C",,,nColuna,,nLin,oFont10)
	Endif 
	ImprG(" ","C",,,nColuna,,nLin,oFont10)
	oPrint:Line(nLin,nColuna ,nLin, nColMax) 
	nLin  += 40 
	If lImpDIni .And. lImpDFim
	ImprG(OemToAnsi(STR0081) + DTOc(dDataIni) + " - " + dtoc(dDataFin)  ,"C",,,nColuna,,nLin,oFont10n)
	Endif
	nLin  += 40 
	oPrint:Line(nLin,nColuna  ,nLin, nColMax) 
	nLin  += 40 
Else
	If Li + 3 >= 60 
		Impr(" ","P")
	Endif

	Impr( repl("-",78),"C",,,01)
	If lImpDIni .And. lImpDFim
	Impr( OemToAnsi(STR0081) + DTOc(dDataIni) + " - " + dtoc(dDataFin),"C",,,01)	
	Endif
	Impr( repl("-",78),"C",,,01)
	
Endif	

RestArea( aArea)
Return 

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³GPER460   ºAutor  ³Microsiga           º Data ³  07/31/06   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
USER FUNCTION PTfDescTarefa(cVar)

Local aArea := GetArea()
Local cRet:= ""

dbSelectArea( "SRX" )

If dbSeek( xFilial( "SRX" ) + "59" + cVar + "1" )
	cRet := SubStr( SRX->RX_TXT,01,30 )
Endif

RestArea( aArea )
Return ( cRet )
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³GPER460   ºAutor  ³Luis Ricardo Cinalliº Data ³ 11/08/2010  º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Ajuste no campo Relacao do dicionario de dados. Nao estava º±±
±±º          ³ tratando a filial certa na busca da Descricao do Cargo.    º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP                                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function AjustaSx3()
Local aArea := GetArea()

// Atualizacao do Inic. Padrao para permitir impressao da descricao 
// do cargo de uma filial a qual o usuario nao esteja logado.
SX3->( dbSetOrder(2)) 
If SX3->( dbSeek( "RA_DCARGO" ) )
	If SX3->X3_RELACAO # 'IF(INCLUI,"",FDESC("SQ3",SRA->RA_CARGO,"Q3_DESCSUM",,SRA->RA_FILIAL))'
		Reclock( "SX3", .F.)
			SX3->X3_RELACAO	:= 'IF(INCLUI,"",FDESC("SQ3",SRA->RA_CARGO,"Q3_DESCSUM",,SRA->RA_FILIAL))'
		MsUnlock()
	EndIf
EndIf		                 

// Atualizacao do Inic. Padrao para permitir impressao da descricao 
// do Sindicato de uma filial a qual o usuario nao esteja logado.
If SX3->( dbSeek( "RA_DESCSIN" ) )
	If SX3->X3_RELACAO # 'Iif(Left(cModulo,1)<>"Q",IF(Inclui,"",fDesc("RCE",SRA->RA_SINDICA,"RCE_DESCRI",,SRA->RA_FILIAL)),"")'
		Reclock( "SX3", .F.)
			SX3->X3_RELACAO	:= 'Iif(Left(cModulo,1)<>"Q",IF(Inclui,"",fDesc("RCE",SRA->RA_SINDICA,"RCE_DESCRI",,SRA->RA_FILIAL)),"")'
		MsUnlock()
	EndIf
EndIf

SX3->( dbSetOrder(1))

RestArea(aArea)
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³AjustaSX1 ºAutor  ³Jonatas A. T. Alves º Data ³  12/04/11   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Inclusao/alteracao de perguntas no SX1.                     º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ GPER460                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function AjustaSx1()

Local aAreaSX1	:= SX1->( GetArea() )
Local aHelpP 	:= {}
Local aHelpE	:= {}
Local aHelpI	:= {}
Local aRegs		:= {}
Local cPerg     := ""

cPerg := If( Len(SX1->X1_GRUPO) > 6, "GPR460    ", "GPR460")

If cPaisLoc == "BRA"

	aHelpP := {	"Informe qual o tipo de tarefa deverá  ",;
	            "ser impresso quando o funcionário for ",;
	            "Professor."}
	
	aHelpE := {	"Informe que tipo de tarea debe        ",;
	            "imprimirse si el empleado fuera       ",;
	            "Profesor.                             "}
	            
	aHelpI := {	"Enter which type of task must be      ",;
	            "printed when the employee is a        ",;
	            "Teacher.                              "}

	Aadd(aRegs,{cPerg,"25","Imprime Tarefas ?","¨Imprime Tareas ?","Print Tasks ?","mv_chp","C",4       ,0      ,0      ,"G" ,"U_PTfGp190TpTa()","mv_par25"  ,""               ,""                     ,""               ,""         ,""    , ""              ,""                ,""               ,""   ,""   ,""                ,""                   ,""                     ,""  ,""   ,""                ,""                 ,""                ,""    ,""    ,""                ,""                 ,""                ,""   ,""   ,""    ,"S"    ,aHelpP,aHelpI,aHelpE,""})
EndIf

If cPaisLoc == "BRA"

	aHelpP := {	"Informe se deseja imprimir as ",;
	            "Contribuições Assistenciais. "}
	
	aHelpE := {	"Informe si desea imprimir las ",;
	            "Contribuciones Asistenciales." }
	            
	aHelpI := {	"Inform if you want to print ",;
	            "the Health Care." }

	Aadd(aRegs,{cPerg,"28","Contrib.Assist.?","¨Contrib.Asist.?","Health Care ?","mv_chs","N",1       ,0      ,2      ,"C" ,"","mv_par28"  ,"Sim"               ,"Si"                     ,"Yes"               ,""         ,""    , "Nao"              ,"No"                ,""               ,""   ,""   ,""                ,""                   ,""                     ,""  ,""   ,""                ,""                 ,""                ,""    ,""    ,""                ,""                 ,""                ,""   ,""   ,""    ,"S"    ,aHelpP,aHelpI,aHelpE,""})

EndIf

ValidPerg(aRegs,cPerg,.F.)			//-- Inclui Pergunta 

RestArea( aAreaSX1 )

Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o	 ³fGp190TpTa³ Autor ³ Jonatas A. T. Alves	³ Data ³ 11/04/11 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Funcao para exibir os tipos de tarefas para selecao		  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe	 ³ fGp190TpTa()												  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ GPER460  												  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
USER Function PTfGp190TpTa()

Local MvPar
Local cTitulo	:= ""
Local MvParDef	:= ""
Local aArea		:= GetArea()

Private aTpTar:={}

MvPar := &(Alltrim(ReadVar()))		 // Carrega Nome da Variavel do Get em Questao
MvRet := Alltrim(ReadVar())			 // Iguala Nome da Variavel ao Nome variavel de Retorno

If lNewProf
	aTpTar :={;
				"1 - " + STR0114,;	//"Fixa"
				"2 - " + STR0115,;	//"Variável"
				"3 - " + STR0116,;	//"Adit. Fixo"
				"4 - " + STR0117;	//"Adit. Var."
			}

	MvParDef	:= "1234"
Else
	aTpTar :={;
				"1 - " + STR0114,;	//"Fixa"
				"2 - " + STR0115;	//"Variável"
			}
			
	MvParDef	:= "12"
EndIf

cTitulo		:= STR0118  //"Tipos de Tarefas"

IF f_Opcoes(@MvPar,cTitulo,aTpTar,MvParDef)  // Chama funcao f_Opcoes
	&MvRet := Mvpar							// Devolve Resultado
EndIF

RestArea(aArea)

Return( .T. )
